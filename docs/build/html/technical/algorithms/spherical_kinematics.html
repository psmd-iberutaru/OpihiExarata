<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Spherical Kinematics &mdash; OpihiExarata 2022.6.17 documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
    <link rel="shortcut icon" href="../../_static/pyukumuku_favicon.png"/>
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Preprocessing" href="../preprocessing/index.html" />
    <link rel="prev" title="Algorithms" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> OpihiExarata
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">User Manual</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../user/index.html">User Manual</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../user/trivia.html">Trivia</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../user/trivia.html#etymology-of-opihiexarata">Etymology of OpihiExarata</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Technical Manual</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Technical Manual</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../installation/index.html">Installation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../installation/download.html">Install: Download</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../installation/download.html#via-git-recommended">Via git (Recommended)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../installation/download.html#via-zip-archive">Via zip archive</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../installation/python.html">Install: Python Part</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../installation/python.html#download">Download</a></li>
<li class="toctree-l4"><a class="reference internal" href="../installation/python.html#build">Build</a></li>
<li class="toctree-l4"><a class="reference internal" href="../installation/python.html#install">Install</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../installation/documentation.html">Optional: Documentation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../installation/documentation.html#prerequisites">Prerequisites</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../installation/documentation.html#sphinx">Sphinx</a></li>
<li class="toctree-l5"><a class="reference internal" href="../installation/documentation.html#latex">LaTeX</a></li>
<li class="toctree-l5"><a class="reference internal" href="../installation/documentation.html#directory">Directory</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../installation/documentation.html#build">Build</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../installation/windows.html">Optional: Windows Compatibility</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../installation/windows.html#powershell-execution-policy">Powershell Execution Policy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../installation/windows.html#windows-subsystem-for-linux">Windows Subsystem for Linux</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../installation/windows.html#modern-install">Modern Install</a></li>
<li class="toctree-l5"><a class="reference internal" href="../installation/windows.html#manual-install">Manual Install</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../installation/windows.html#verify">Verify</a></li>
<li class="toctree-l4"><a class="reference internal" href="../installation/windows.html#final">Final</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../installation/orbfit.html">Install: Orbfit</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../installation/orbfit.html#prerequisites">Prerequisites</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../installation/orbfit.html#directory">Directory</a></li>
<li class="toctree-l5"><a class="reference internal" href="../installation/orbfit.html#dependencies">Dependencies</a></li>
<li class="toctree-l5"><a class="reference internal" href="../installation/orbfit.html#fortran-compiler">Fortran Compiler</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../installation/orbfit.html#download-orbfit">Download OrbFit</a></li>
<li class="toctree-l4"><a class="reference internal" href="../installation/orbfit.html#compile">Compile</a></li>
<li class="toctree-l4"><a class="reference internal" href="../installation/orbfit.html#download-jpl-ephemerides-file">Download JPL Ephemerides File</a></li>
<li class="toctree-l4"><a class="reference internal" href="../installation/orbfit.html#testing-suite">Testing Suite</a></li>
<li class="toctree-l4"><a class="reference internal" href="../installation/orbfit.html#executable-path-for-configuration-file">Executable Path for Configuration File</a></li>
<li class="toctree-l4"><a class="reference internal" href="../installation/orbfit.html#opihiexarata-template-files">OpihiExarata Template Files</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Algorithms</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Spherical Kinematics</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#definitions">Definitions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#deriving-rates">Deriving Rates</a></li>
<li class="toctree-l4"><a class="reference internal" href="#spherical-motion">Spherical Motion</a></li>
<li class="toctree-l4"><a class="reference internal" href="#celestial-sphere">Celestial Sphere</a></li>
<li class="toctree-l4"><a class="reference internal" href="#lemmas">Lemmas</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#derivation-of-vector-equation-of-motion">Derivation of Vector Equation of Motion</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../preprocessing/index.html">Preprocessing</a><ul class="simple">
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Code Manual</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../code/modules.html">opihiexarata</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../code/opihiexarata.html">opihiexarata package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../code/opihiexarata.html#subpackages">Subpackages</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../code/opihiexarata.astrometry.html">opihiexarata.astrometry package</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../code/opihiexarata.astrometry.html#submodules">Submodules</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../code/opihiexarata.astrometry.html#module-opihiexarata.astrometry">Module contents</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../code/opihiexarata.ephemeris.html">opihiexarata.ephemeris package</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../code/opihiexarata.ephemeris.html#submodules">Submodules</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../code/opihiexarata.ephemeris.html#module-opihiexarata.ephemeris">Module contents</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../code/opihiexarata.gui.html">opihiexarata.gui package</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../code/opihiexarata.gui.html#subpackages">Subpackages</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../code/opihiexarata.gui.html#submodules">Submodules</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../code/opihiexarata.gui.html#module-opihiexarata.gui">Module contents</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../code/opihiexarata.library.html">opihiexarata.library package</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../code/opihiexarata.library.html#submodules">Submodules</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../code/opihiexarata.library.html#module-opihiexarata.library">Module contents</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../code/opihiexarata.opihi.html">opihiexarata.opihi package</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../code/opihiexarata.opihi.html#submodules">Submodules</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../code/opihiexarata.opihi.html#module-opihiexarata.opihi">Module contents</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../code/opihiexarata.orbit.html">opihiexarata.orbit package</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../code/opihiexarata.orbit.html#submodules">Submodules</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../code/opihiexarata.orbit.html#module-opihiexarata.orbit">Module contents</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../code/opihiexarata.photometry.html">opihiexarata.photometry package</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../code/opihiexarata.photometry.html#submodules">Submodules</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../code/opihiexarata.photometry.html#module-opihiexarata.photometry">Module contents</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../code/opihiexarata.propagate.html">opihiexarata.propagate package</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../code/opihiexarata.propagate.html#submodules">Submodules</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../code/opihiexarata.propagate.html#module-opihiexarata.propagate">Module contents</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../code/opihiexarata.html#module-opihiexarata">Module contents</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">OpihiExarata</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../index.html">Technical Manual</a> &raquo;</li>
          <li><a href="index.html">Algorithms</a> &raquo;</li>
      <li>Spherical Kinematics</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/technical/algorithms/spherical_kinematics.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="spherical-kinematics">
<h1>Spherical Kinematics<a class="headerlink" href="#spherical-kinematics" title="Permalink to this heading"></a></h1>
<p>Here we detail the algorithm for computing the propagation of the position of
an asteroid given observations. This method uses the laws of kinematic motion
in spherical coordinates.</p>
<section id="definitions">
<h2>Definitions<a class="headerlink" href="#definitions" title="Permalink to this heading"></a></h2>
<p>We are using spherical coordinates, namely the coordinates
<span class="math notranslate nohighlight">\((r, \theta, \phi)\)</span> for the radial distance, polar angle, and azimuthal
angle respectively. In relation to astrometric coordinates RA and DEC,
<span class="math notranslate nohighlight">\((\alpha, \delta)\)</span>:</p>
<div class="math notranslate nohighlight">
\[\alpha = \phi   \qquad   \delta = \frac{\pi}{2} - \theta\]</div>
<p>Observations taken by the Opihi telescoped and processed by OpihiExarata are
represented as <span class="math notranslate nohighlight">\((\alpha_n, \delta_n, t_n)\)</span>. These correspond to the
temporal spherical coordinates <span class="math notranslate nohighlight">\((r=1, \phi_n, \delta_n, t_n)\)</span>. For
<span class="math notranslate nohighlight">\(t\)</span> is the absolute time of the observation; UNIX time or Julian date
time works best.</p>
<p>Moreover, in spherical coordinates, the position, velocity, and acceleration
vectors are given as: (see <a class="reference external" href="http://www.worldcat.org/oclc/1104053368">Keplerian Ellipses Chapter 2 Reed 2019</a>)</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mathbf{r} &amp;= r \mathbf{\hat r} \\
\mathbf{v} &amp;= \dot{r} \mathbf{\hat r} + r \dot\theta \hat{\boldsymbol\theta } + r \dot\phi \sin\theta \mathbf{\hat{\boldsymbol\phi}} \\
\mathbf{a} &amp;= \left(\ddot{r} - r\dot\theta^2 - r\dot\phi^2\sin^2\theta \right)\mathbf{\hat r} \\
 &amp;\quad + \left( r\ddot\theta + 2\dot{r}\dot\theta - r\dot\phi^2\sin\theta\cos\theta \right) \hat{\boldsymbol\theta } \\
 &amp;\quad + \left( r\ddot\phi\sin\theta + 2\dot{r}\dot\phi\sin\theta + 2 r\dot\theta\dot\phi\cos\theta \right) \hat{\boldsymbol\phi}\end{split}\]</div>
<p>Where the basis vectors of the spherical coordinates are:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\hat{\mathbf r} &amp;= \sin\theta \cos\phi \hat{\mathbf x} + \sin\theta \sin\phi \hat{\mathbf y} + \cos\theta \hat{\mathbf z} \\
\hat{\boldsymbol\theta} &amp;= \cos\theta \cos\phi \hat{\mathbf x} + \cos\theta \sin\phi \hat{\mathbf y} - \sin\theta \hat{\mathbf z} \\
\hat{\boldsymbol\phi} &amp;= - \sin\phi \hat{\mathbf x} + \cos\phi \hat{\mathbf y} + 0 \hat{\mathbf z}\end{split}\]</div>
<p>However, for the purposes of finding by propagation, we only care about the
location of the asteroid on the sky as determined by the celestial coordinates.
The distance from the origin of the coordinate system does not change. Thus:</p>
<div class="math notranslate nohighlight">
\[r = 1 \qquad \dot{r} = \ddot{r} = 0\]</div>
<p>And thus the kinematic vectors are:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mathbf{r} &amp;= \mathbf{\hat r} \\
\mathbf{v} &amp;=  \dot\theta \hat{\boldsymbol\theta } + \dot\phi \sin\theta \mathbf{\hat{\boldsymbol\phi}} \\
\mathbf{a} &amp;= \left(-\dot\theta^2 - \dot\phi^2\sin^2\theta \right) \mathbf{\hat r} + \left(\ddot\theta - \dot\phi^2\sin\theta\cos\theta \right) \hat{\boldsymbol\theta } + \left(\ddot\phi\sin\theta  + 2 \dot\theta\dot\phi\cos\theta \right) \hat{\boldsymbol\phi}\end{split}\]</div>
<p>We can convert these vectors to Cartesian coordinates using the matrix
transformation. The spherical to Cartesian transformation matrix
<span class="math notranslate nohighlight">\(\mathbf{R}\)</span> can be derived from the defining angles of the spherical
coordinate system <span class="math notranslate nohighlight">\(\theta\)</span> and <span class="math notranslate nohighlight">\(\phi\)</span>. Where
<span class="math notranslate nohighlight">\(\mathbf{u}_\text{cart} = \mathbf{R} \mathbf{u}_\text{sph}\)</span>.:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mathbf{R} = \begin{bmatrix}
\sin\theta\cos\phi &amp; \cos\theta\cos\phi &amp; -\sin\phi \\
\sin\theta\sin\phi &amp; \cos\theta\sin\phi &amp;  \cos\phi \\
\cos\theta         &amp; -\sin\theta        &amp; 0
\end{bmatrix}\end{split}\]</div>
<p>Thus, in Cartesian coordinates:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mathbf{r} &amp;= \mathbf{R} \begin{bmatrix} 1 \\ 0 \\ 0 \end{bmatrix} \\
\mathbf{v} &amp;= \mathbf{R} \begin{bmatrix} 0 \\ \dot\theta \\ \dot\phi \sin\theta \end{bmatrix} \\
\mathbf{a} &amp;= \mathbf{R} \begin{bmatrix} -\dot\theta^2 - \dot\phi^2\sin^2\theta \\ \ddot\theta - \dot\phi^2\sin\theta\cos\theta \\ \ddot\phi\sin\theta  + 2 \dot\theta\dot\phi\cos\theta \end{bmatrix}\end{split}\]</div>
<p>Generally, as kinematics are defined based on the time derivatives, the general
equation of motion for constant acceleration can be used to determine the
movement of the position vector representing the asteroid:</p>
<div class="math notranslate nohighlight">
\[\mathbf{r} \triangleq \mathbf{r} \qquad \mathbf{v} \triangleq \frac{\mathrm{d}\mathbf{r}}{\mathrm{d}t} \qquad \mathbf{a} \triangleq \frac{\mathrm{d}^2\mathbf{r}}{\mathrm{d}t^2} \qquad \mathbf{j} \triangleq \frac{\mathrm{d}^3\mathbf{r}}{\mathrm{d}t^3} = 0\]</div>
<div class="math notranslate nohighlight">
\[\mathbf{r} = \mathbf{r}_0 + \mathbf{v}_0 \tau + \frac{1}{2} \mathbf{a} \tau^2\]</div>
<p>Where <span class="math notranslate nohighlight">\(\tau\)</span> is the time interval between the defining time of
observation to the current time.</p>
</section>
<section id="deriving-rates">
<h2>Deriving Rates<a class="headerlink" href="#deriving-rates" title="Permalink to this heading"></a></h2>
<p>Multiple observations from Opihi provides multiple sightings of an asteroid at
many different points in the sky, providing multiple RA and DEC coordinates,
<span class="math notranslate nohighlight">\(\alpha_n\)</span> and <span class="math notranslate nohighlight">\(\delta_n\)</span> at time <span class="math notranslate nohighlight">\(t_n\)</span>. We have a total of
<span class="math notranslate nohighlight">\(N\)</span> RA DEC observations. (The propagation calculation will need to be redone for
a new observation set <span class="math notranslate nohighlight">\(N' = N + 1\)</span>.)</p>
<p>We can convert this to spherical coordinates with <span class="math notranslate nohighlight">\(\phi_n = \alpha_n\)</span> and <span class="math notranslate nohighlight">\(\theta_n = \frac{\pi}{2} - \delta_n\)</span>.</p>
<p>These multiple observations allows for the determination of the rates of
change of spherical coordinates for the asteroid, namely: (For the time
difference <span class="math notranslate nohighlight">\(t_\Delta = t_{n+1} - t_n\)</span>.)</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\dot\theta_p = \frac{\theta_{n+1} - \theta_{n}}{t_{n+1} - t_n}\\\dot\phi_p = \frac{\phi_{n+1} - \phi_{n}}{t_{n+1} - t_n}\\t'_p = \frac{1}{2} \left( t_{n+1} + t_n \right)\end{aligned}\end{align} \]</div>
<p>…and…</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\ddot\theta_q = \frac{\dot\theta_{p+1} - \dot\theta_{p}}{t'_{p+1} - t'_p}\\\ddot\phi_q = \frac{\dot\phi_{p+1} - \dot\phi_{p}}{t'_{p+1} - t'_p}\end{aligned}\end{align} \]</div>
<p>The first order rates changes over time. As such, it is required that two
observations be reserved as special observations which the first order rates
are calculated and to established the spherical coordinate system itself.
Although it does not need to be the first two observations, it is often
connivent to use them. As such, using the first two observations
<span class="math notranslate nohighlight">\(n=0\)</span> and <span class="math notranslate nohighlight">\(n=1\)</span>, we have:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\theta &amp;= \theta_0 \\
\phi &amp;= \phi_0 \\
\dot\theta &amp;= \dot\theta_0 = \frac{\theta_1 - \theta_0}{t_1 - t_0} \\
\dot\phi &amp;= \dot\phi_0 = \frac{\phi_1 - \phi_0}{t_1 - t_0} \\\end{split}\]</div>
<p>Because we assume constant acceleration (<span class="math notranslate nohighlight">\(\mathbf{j} = 0\)</span>), the second
differential values are assumed to be constant and thus an average is more
representational of the value. (A mean or median is valid.)</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\ddot\theta = \frac{1}{Q} \sum_q^Q \ddot\theta_q \approx \mathrm{median} (\ddot\theta_q)\\\ddot\phi = \frac{1}{Q} \sum_q^Q \ddot\phi_q \approx \mathrm{median} (\ddot\phi_q)\end{aligned}\end{align} \]</div>
<p>In the case for <span class="math notranslate nohighlight">\(N=2\)</span>, then the total number of derived angular first
order rates is <span class="math notranslate nohighlight">\(P=1\)</span>. As such the second order rates cannot be
calculated and <span class="math notranslate nohighlight">\(Q=0\)</span> (the cardinality of the arrays are zero). By
default, for this special case:</p>
<div class="math notranslate nohighlight">
\[\#(\ddot\theta_q) = \#(\ddot\phi_q) = 0 \implies Q = 0 \longrightarrow \ddot\theta = 0 \quad \ddot\phi = 0\]</div>
</section>
<section id="spherical-motion">
<h2>Spherical Motion<a class="headerlink" href="#spherical-motion" title="Permalink to this heading"></a></h2>
<p>With the 0th, 1st, and 2nd order rates calculated from the set of <span class="math notranslate nohighlight">\(N\)</span>
observations, the kinematic vectors can be calculated. The special
observations defining the coordinate system and the velocities also define
the initial vectors from which kinematics shall be applied to. The
acceleration vector, being constant means <span class="math notranslate nohighlight">\(\mathbf{a}_0 = \mathbf{a}\)</span>.
Namely, these vectors are, in Cartesian coordinates,</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mathbf{r_0} &amp;= \begin{bmatrix}
\sin\theta\cos\phi &amp; \cos\theta\cos\phi &amp; -\sin\phi \\
\sin\theta\sin\phi &amp; \cos\theta\sin\phi &amp;  \cos\phi \\
\cos\theta         &amp; -\sin\theta        &amp; 0
\end{bmatrix} \begin{bmatrix} 1 \\ 0 \\ 0 \end{bmatrix} \\
\mathbf{v_0} &amp;= \begin{bmatrix}
\sin\theta\cos\phi &amp; \cos\theta\cos\phi &amp; -\sin\phi \\
\sin\theta\sin\phi &amp; \cos\theta\sin\phi &amp;  \cos\phi \\
\cos\theta         &amp; -\sin\theta        &amp; 0
\end{bmatrix} \begin{bmatrix} 0 \\ \dot\theta \\ \dot\phi \sin\theta \end{bmatrix} \\
\mathbf{a} &amp;= \begin{bmatrix}
\sin\theta\cos\phi &amp; \cos\theta\cos\phi &amp; -\sin\phi \\
\sin\theta\sin\phi &amp; \cos\theta\sin\phi &amp;  \cos\phi \\
\cos\theta         &amp; -\sin\theta        &amp; 0
\end{bmatrix} \begin{bmatrix} -\dot\theta^2 - \dot\phi^2\sin^2\theta \\ \ddot\theta - \dot\phi^2\sin\theta\cos\theta \\ \ddot\phi\sin\theta  + 2 \dot\theta\dot\phi\cos\theta \end{bmatrix}\end{split}\]</div>
<p>All three of these vectors are constant in future time. The position at a
set of future observations at time(s) <span class="math notranslate nohighlight">\(t^+_i\)</span> can be calculated using
the kinematic equation; the time intervals <span class="math notranslate nohighlight">\(\tau_i\)</span> being
<span class="math notranslate nohighlight">\(\tau_i = t^+_i - t_0\)</span>:</p>
<div class="math notranslate nohighlight">
\[\mathbf{r}^+_i = \mathbf{r}_0 + \mathbf{v}_0 \left(t^+_i - t_0\right) + \frac{1}{2} \mathbf{a} \left(t^+_i - t_0\right)^2\]</div>
</section>
<section id="celestial-sphere">
<h2>Celestial Sphere<a class="headerlink" href="#celestial-sphere" title="Permalink to this heading"></a></h2>
<p>These new future position vectors <span class="math notranslate nohighlight">\(\mathbf{r}^+_i\)</span> are in Cartesian
coordinates. The calculations should be done in Cartesian, provided the
conversion earlier.</p>
<p>Each position vector can be represented as:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mathbf{r}^+_i = X_i \mathbf{\hat x} + Y_i \mathbf{\hat y} + Z_i \mathbf{\hat z} = \begin{bmatrix} X_i \\ Y_i \\ Z_i \end{bmatrix}\end{split}\]</div>
<p>These Cartesian coordinate position vectors, centered on the origin, represents
where the asteroid is on the celestial sphere in the future at an observation
time of <span class="math notranslate nohighlight">\(t^+_i\)</span>. From these Cartesian coordinates, we can extract their
location in spherical coordinates,</p>
<div class="math notranslate nohighlight">
\[\begin{split}r^+_i &amp;= \sqrt{X_i^2 + Y_i^2 + Z_i^2} \\
\theta^+_i &amp;= \arccos\left(\frac{Z_i}{r^+_i}\right) = \arccos\left(\frac{Z_i}{\sqrt{X_i^2 + Y_i^2 + Z_i^2}}\right) \\
\phi^+_i &amp;= \arctan\!2(Y_i, X_i) \simeq \arctan\left(\frac{Y_i}{X_i}\right)\end{split}\]</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In order to properly handle the quadrant issue, the 2-argument arctangent is
required. Moreover, if the 2-argument arctangent function returns in a range
<span class="math notranslate nohighlight">\(-\pi \leq \angle \leq \pi\)</span>, it can be converted to the usual range of
<span class="math notranslate nohighlight">\(0 \leq \phi \leq 2\pi\)</span> with: <span class="math notranslate nohighlight">\(\phi = \angle \mod 2\pi\)</span>
or <span class="math notranslate nohighlight">\(\phi = \angle \mod 360^\circ\)</span></p>
</div>
<p>These spherical coordinate locations can then be converted into future RA and
DEC temporal coordinates <span class="math notranslate nohighlight">\((\alpha^+_i, \delta^+_i, t^+_i)\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\alpha^+_i &amp;= \phi^+_i \\
\delta^+_i &amp;= \frac{\pi}{2} - \theta^+_i \\
t^+_i &amp;= t^+_i\end{split}\]</div>
</section>
<section id="lemmas">
<h2>Lemmas<a class="headerlink" href="#lemmas" title="Permalink to this heading"></a></h2>
<section id="derivation-of-vector-equation-of-motion">
<h3>Derivation of Vector Equation of Motion<a class="headerlink" href="#derivation-of-vector-equation-of-motion" title="Permalink to this heading"></a></h3>
<p>Newton’s second law and constant acceleration stipulates:</p>
<div class="math notranslate nohighlight">
\[\mathbf{F} = m \mathbf{a} = m \ddot{\mathbf{r}} \qquad \dot{\mathbf{F}} = 0\]</div>
<p>This thus provides the differential equation of motion (For constant <span class="math notranslate nohighlight">\(\mathbf{F}\)</span>.)</p>
<div class="math notranslate nohighlight">
\[\ddot{\mathbf{r}} = \frac{\mathrm{d}^2\mathbf{r}}{\mathrm{d}t^2} = \frac{\mathbf{F}}{m}\]</div>
<p>We define based on the laws of integrations (and in essence the fundamental
theorem of calculus):</p>
<div class="math notranslate nohighlight">
\[\dot{\mathbf{f}} \triangleq \frac{\mathrm{d}\mathbf{f}}{\mathrm{d}t} \Longleftrightarrow \int \dot{\mathbf{f}} \mathrm{d} t = \mathbf{f} + \mathbf{C}\]</div>
<div class="math notranslate nohighlight">
\[\int \frac{\mathrm{d}\mathbf{f}}{\mathrm{d}t} \mathrm{d} t = \mathbf{f}\]</div>
<p>We can solve the differential equation of motion:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\ddot{\mathbf{r}} &amp;= \frac{\mathbf{F}}{m} \\
\frac{\mathrm{d}}{\mathrm{d}t} \left( \frac{\mathrm{d}\mathbf{r}}{\mathrm{d}t} \right) &amp;= \frac{\mathbf{F}}{m} \\
\int \frac{\mathrm{d}}{\mathrm{d}t} \left( \frac{\mathrm{d}\mathbf{r}}{\mathrm{d}t} \right) \mathrm{d}t &amp;= \int \frac{\mathbf{F}}{m} \mathrm{d}t = \frac{\mathbf{F}}{m} \int 1 \mathrm{d}t = \frac{\mathbf{F}}{m} t + \mathbf{C_1} \\
\frac{\mathrm{d}\mathbf{r}}{\mathrm{d}t} &amp;= \frac{\mathbf{F}}{m} t + \mathbf{C_1} \\
\int \frac{\mathrm{d}\mathbf{r}}{\mathrm{d}t} \mathrm{d}t &amp;= \int \frac{\mathbf{F}}{m} t + \mathbf{C_1} \mathrm{d}t = \frac{\mathbf{F}}{m} \int t \mathrm{d}t + \int \mathbf{C_1} \mathrm{d}t = \frac{\mathbf{F}}{m} \frac{1}{2} t^2 + \mathbf{C_1} t + \mathbf{C_2} \\
\mathbf{r} &amp;= \frac{\mathbf{F}}{m} \frac{1}{2} t^2 + \mathbf{C_1} t + \mathbf{C_2}\end{split}\]</div>
<p>For the initial conditions:</p>
<div class="math notranslate nohighlight">
\[\begin{split}t = 0 &amp;\implies \mathbf{r} = \mathbf{C_2} = \mathbf{r_0} \\
t = 0 &amp;\implies \frac{\mathrm{d}\mathbf{r}}{\mathrm{d}t} = \mathbf{C_1} = \mathbf{v_0} \\
\dot{\mathbf{F}} = 0 &amp;\implies \frac{\mathrm{d}^2\mathbf{r}}{\mathrm{d}t^2} = \frac{\mathbf{F}}{m} = \mathbf{a_0} = \mathbf{a}\end{split}\]</div>
<p>Thus, the total valid solution is:</p>
<div class="math notranslate nohighlight">
\[\mathbf{r} = \mathbf{r_0} + \mathbf{v_0} t + \frac{1}{2} \mathbf{a} t^2\]</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="Algorithms" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../preprocessing/index.html" class="btn btn-neutral float-right" title="Preprocessing" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Kenji Sparrow Emerson.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script> 

</body>
</html>