<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>opihiexarata.gui.manual &mdash; OpihiExarata 2022.6.13 documentation</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
    <link rel="shortcut icon" href="../../../_static/pyukumuku_favicon.png"/>
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../../index.html" class="icon icon-home"> OpihiExarata
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">User Manual</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../user/index.html">User Manual</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../user/trivia.html">Trivia</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../user/trivia.html#etymology-of-opihiexarata">Etymology of OpihiExarata</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Technical Manual</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../technical/index.html">Technical Manual</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../technical/installation/index.html">Installation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../technical/installation/download.html">Install: Download</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../technical/installation/download.html#via-git-recommended">Via git (Recommended)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../technical/installation/download.html#via-zip-archive">Via zip archive</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../technical/installation/python.html">Install: Python Part</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../technical/installation/python.html#download">Download</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../technical/installation/python.html#build">Build</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../technical/installation/python.html#install">Install</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../technical/installation/documentation.html">Optional: Documentation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../technical/installation/documentation.html#prerequisites">Prerequisites</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../technical/installation/documentation.html#sphinx">Sphinx</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../technical/installation/documentation.html#latex">LaTeX</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../technical/installation/documentation.html#directory">Directory</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../technical/installation/documentation.html#build">Build</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../technical/installation/windows.html">Optional: Windows Compatibility</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../technical/installation/windows.html#powershell-execution-policy">Powershell Execution Policy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../technical/installation/windows.html#windows-subsystem-for-linux">Windows Subsystem for Linux</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../technical/installation/windows.html#modern-install">Modern Install</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../technical/installation/windows.html#manual-install">Manual Install</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../technical/installation/windows.html#verify">Verify</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../technical/installation/windows.html#final">Final</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../technical/installation/orbfit.html">Install: Orbfit</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../technical/installation/orbfit.html#prerequisites">Prerequisites</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../technical/installation/orbfit.html#directory">Directory</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../technical/installation/orbfit.html#dependencies">Dependencies</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../technical/installation/orbfit.html#fortran-compiler">Fortran Compiler</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../technical/installation/orbfit.html#download-orbfit">Download OrbFit</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../technical/installation/orbfit.html#compile">Compile</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../technical/installation/orbfit.html#download-jpl-ephemerides-file">Download JPL Ephemerides File</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../technical/installation/orbfit.html#testing-suite">Testing Suite</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../technical/installation/orbfit.html#executable-path-for-configuration-file">Executable Path for Configuration File</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../technical/installation/orbfit.html#opihiexarata-template-files">OpihiExarata Template Files</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../technical/algorithms/index.html">Algorithms</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../technical/algorithms/spherical_kinematics.html">Spherical Kinematics</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../technical/algorithms/spherical_kinematics.html#definitions">Definitions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../technical/algorithms/spherical_kinematics.html#deriving-rates">Deriving Rates</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../technical/algorithms/spherical_kinematics.html#spherical-motion">Spherical Motion</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../technical/algorithms/spherical_kinematics.html#celestial-sphere">Celestial Sphere</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../technical/algorithms/spherical_kinematics.html#lemmas">Lemmas</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../technical/algorithms/spherical_kinematics.html#derivation-of-vector-equation-of-motion">Derivation of Vector Equation of Motion</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../technical/preprocessing/index.html">Preprocessing</a><ul class="simple">
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Code Manual</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../code/modules.html">opihiexarata</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../code/opihiexarata.html">opihiexarata package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../code/opihiexarata.html#subpackages">Subpackages</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../code/opihiexarata.astrometry.html">opihiexarata.astrometry package</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../code/opihiexarata.astrometry.html#submodules">Submodules</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../code/opihiexarata.astrometry.html#module-opihiexarata.astrometry">Module contents</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../code/opihiexarata.ephemeris.html">opihiexarata.ephemeris package</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../code/opihiexarata.ephemeris.html#submodules">Submodules</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../code/opihiexarata.ephemeris.html#module-opihiexarata.ephemeris">Module contents</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../code/opihiexarata.gui.html">opihiexarata.gui package</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../code/opihiexarata.gui.html#subpackages">Subpackages</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../code/opihiexarata.gui.html#submodules">Submodules</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../code/opihiexarata.gui.html#module-opihiexarata.gui">Module contents</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../code/opihiexarata.library.html">opihiexarata.library package</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../code/opihiexarata.library.html#submodules">Submodules</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../code/opihiexarata.library.html#module-opihiexarata.library">Module contents</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../code/opihiexarata.opihi.html">opihiexarata.opihi package</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../code/opihiexarata.opihi.html#submodules">Submodules</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../code/opihiexarata.opihi.html#module-opihiexarata.opihi">Module contents</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../code/opihiexarata.orbit.html">opihiexarata.orbit package</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../code/opihiexarata.orbit.html#submodules">Submodules</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../code/opihiexarata.orbit.html#module-opihiexarata.orbit">Module contents</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../code/opihiexarata.photometry.html">opihiexarata.photometry package</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../code/opihiexarata.photometry.html#submodules">Submodules</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../code/opihiexarata.photometry.html#module-opihiexarata.photometry">Module contents</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../code/opihiexarata.propagate.html">opihiexarata.propagate package</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../code/opihiexarata.propagate.html#submodules">Submodules</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../code/opihiexarata.propagate.html#module-opihiexarata.propagate">Module contents</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../code/opihiexarata.html#module-opihiexarata">Module contents</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">OpihiExarata</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../../index.html">Module code</a> &raquo;</li>
      <li>opihiexarata.gui.manual</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for opihiexarata.gui.manual</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">The manual GUI window.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="kn">from</span> <span class="nn">PySide6</span> <span class="kn">import</span> <span class="n">QtCore</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="p">,</span> <span class="n">QtGui</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">matplotlib.backends.backend_qt5agg</span> <span class="kn">import</span> <span class="n">FigureCanvasQTAgg</span> <span class="k">as</span> <span class="n">FigureCanvas</span>
<span class="kn">from</span> <span class="nn">matplotlib.backends.backend_qt5agg</span> <span class="kn">import</span> <span class="n">NavigationToolbar2QT</span> <span class="k">as</span> <span class="n">NavigationToolbar</span>

<span class="kn">import</span> <span class="nn">opihiexarata</span>
<span class="kn">import</span> <span class="nn">opihiexarata.library</span> <span class="k">as</span> <span class="nn">library</span>
<span class="kn">import</span> <span class="nn">opihiexarata.library.error</span> <span class="k">as</span> <span class="nn">error</span>
<span class="kn">import</span> <span class="nn">opihiexarata.library.hint</span> <span class="k">as</span> <span class="nn">hint</span>

<span class="kn">import</span> <span class="nn">opihiexarata.astrometry</span> <span class="k">as</span> <span class="nn">astrometry</span>
<span class="kn">import</span> <span class="nn">opihiexarata.photometry</span> <span class="k">as</span> <span class="nn">photometry</span>
<span class="kn">import</span> <span class="nn">opihiexarata.propagate</span> <span class="k">as</span> <span class="nn">propagate</span>
<span class="kn">import</span> <span class="nn">opihiexarata.orbit</span> <span class="k">as</span> <span class="nn">orbit</span>
<span class="kn">import</span> <span class="nn">opihiexarata.ephemeris</span> <span class="k">as</span> <span class="nn">ephemeris</span>

<span class="kn">import</span> <span class="nn">opihiexarata.gui</span> <span class="k">as</span> <span class="nn">gui</span>


<div class="viewcode-block" id="OpihiManualWindow"><a class="viewcode-back" href="../../../code/opihiexarata.gui.manual.html#opihiexarata.gui.manual.OpihiManualWindow">[docs]</a><span class="k">class</span> <span class="nc">OpihiManualWindow</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QMainWindow</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;The GUI that is responsible for interaction between the user and the</span>
<span class="sd">    two Opihi solutions, the image (OpihiPreprocessSolution) and the</span>
<span class="sd">    results (OpihiSolution).</span>

<span class="sd">    Only non-GUI attributes are listed here.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    asteroid_set_name : string</span>
<span class="sd">        The current asteroid name provided by the user.</span>
<span class="sd">    raw_fits_filename : string</span>
<span class="sd">        The raw input filename. This file is usually preprocessed before </span>
<span class="sd">        analysis.</span>
<span class="sd">    raw_record_filename : string</span>
<span class="sd">        The raw MPC record filename. This contains historical asteroid </span>
<span class="sd">        information collected (with the unique identifier being the name).</span>
<span class="sd">    process_fits_filename : string</span>
<span class="sd">        The filename of the preprocessed image, this is generally generated </span>
<span class="sd">        automatically by the preprocess solution. This file is generally used </span>
<span class="sd">        for analysis.</span>
<span class="sd">    preprocess_solution : OpihiPreprocessSolution</span>
<span class="sd">        The preprocessing solution which is used to convert raw images to </span>
<span class="sd">        preprocessed files.</span>
<span class="sd">    opihi_solution : OpihiSolution</span>
<span class="sd">        The general OpihiExarata solution, the collection class of all other </span>
<span class="sd">        solutions.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="OpihiManualWindow.__init__"><a class="viewcode-back" href="../../../code/opihiexarata.gui.manual.html#opihiexarata.gui.manual.OpihiManualWindow.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;The manual GUI window for OpihiExarata. This interacts directly</span>
<span class="sd">        with the total solution object of Opihi.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Creating the GUI itself using the Qt framework and the converted</span>
        <span class="c1"># Qt designer files.</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">OpihiManualWindow</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span> <span class="o">=</span> <span class="n">gui</span><span class="o">.</span><span class="n">qtui</span><span class="o">.</span><span class="n">Ui_ManualWindow</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">setupUi</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="c1"># Establishing the defaults for all of the relevant attributes.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">asteroid_set_name</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">raw_fits_filename</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">raw_record_filename</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">process_fits_filename</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">preprocess_solution</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">opihi_solution</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># Preparing the image area for Opihi sky images.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__init_opihi_image</span><span class="p">()</span>

        <span class="c1"># Preparing the buttons, GUI, and other functionality.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__init_gui_connections</span><span class="p">()</span>

        <span class="c1"># Preparing the preprocessing solution so that the raw files loaded</span>
        <span class="c1"># into Exarata can be instantly turned into reduced images.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__init_preprocess_solution</span><span class="p">()</span>

        <span class="c1"># All done.</span>
        <span class="k">return</span> <span class="kc">None</span></div>

    <span class="k">def</span> <span class="nf">__init_gui_connections</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Assign the action bindings for the buttons which get new</span>
<span class="sd">        file(names).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># The new file and new object buttons.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">push_button_new_image_automatic</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__connect_push_button_new_image_automatic</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">push_button_new_image_manual</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__connect_push_button_new_image_manual</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">push_button_new_target</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__connect_push_button_new_target</span>
        <span class="p">)</span>

        <span class="c1"># The window and plot refresh button.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">push_button_refresh_window</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__connect_push_button_refresh_window</span>
        <span class="p">)</span>

        <span class="c1"># Astrometry-specific buttons.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">push_button_astrometry_solve_astrometry</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__connect_push_button_astrometry_solve_astrometry</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">push_button_astrometry_custom_solve</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__connect_push_button_astrometry_custom_solve</span>
        <span class="p">)</span>

        <span class="c1"># Photometry-specific buttons.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">push_button_photometry_solve_photometry</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__connect_push_button_photometry_solve_photometry</span>
        <span class="p">)</span>

        <span class="c1"># Orbit-specific buttons.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">push_button_orbit_solve_orbit</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__connect_push_button_orbit_solve_orbit</span>
        <span class="p">)</span>

        <span class="c1"># Ephemeris-specific buttons.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">push_button_ephemeris_solve_ephemeris</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__connect_push_button_orbit_solve_ephemeris</span>
        <span class="p">)</span>

        <span class="c1"># Propagate-specific buttons.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">push_button_propagate_solve_propagation</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__connect_push_button_propagate_solve_propagation</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">push_button_propagate_custom_solve</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__connect_push_button_propagate_custom_solve</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">__init_opihi_image</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Create the image area which will display what Opihi took from the</span>
<span class="sd">        sky. This takes advantage of a reserved image vertical layout in the</span>
<span class="sd">        design of the window.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Deriving the size of the image from the filler dummy image. The</span>
        <span class="c1"># figure should be a square. (Height really is the primary concern.)</span>
        <span class="n">pix_to_in</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">p</span><span class="p">:</span> <span class="n">p</span> <span class="o">/</span> <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;figure.dpi&quot;</span><span class="p">]</span>
        <span class="n">dummy_edge_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">dummy_opihi_image</span><span class="o">.</span><span class="n">height</span><span class="p">()</span>
        <span class="n">edge_size</span> <span class="o">=</span> <span class="n">pix_to_in</span><span class="p">(</span><span class="n">dummy_edge_size</span><span class="p">)</span>
        <span class="c1"># The figure, canvas, and navigation toolbar of the image plot</span>
        <span class="c1"># using a Matplotlib Qt widget backend. We will add these to the</span>
        <span class="c1"># layout later.</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">edge_size</span><span class="p">,</span> <span class="n">edge_size</span><span class="p">),</span> <span class="n">constrained_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">opihi_figure</span> <span class="o">=</span> <span class="n">fig</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">opihi_axes</span> <span class="o">=</span> <span class="n">ax</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">opihi_canvas</span> <span class="o">=</span> <span class="n">FigureCanvas</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">opihi_figure</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">opihi_nav_toolbar</span> <span class="o">=</span> <span class="n">NavigationToolbar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">opihi_canvas</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>

        <span class="c1"># For ease of usage, a custom navigation bar coordinate formatter</span>
        <span class="c1"># function/class is used.</span>
        <span class="k">class</span> <span class="nc">CoordinateFormatter</span><span class="p">:</span>
            <span class="sd">&quot;&quot;&quot;A simple function class to properly format the navigation bar</span>
<span class="sd">            coordinate text. This assumes the current structure of the GUI.&quot;&quot;&quot;</span>

            <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gui_instance</span><span class="p">:</span> <span class="n">OpihiManualWindow</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">gui_instance</span> <span class="o">=</span> <span class="n">gui_instance</span>
                <span class="k">return</span> <span class="kc">None</span>

            <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
                <span class="sd">&quot;&quot;&quot;The coordinate string going to be put onto the navigation</span>
<span class="sd">                bar.&quot;&quot;&quot;</span>
                <span class="c1"># The pixel locations.</span>
                <span class="n">x_index</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
                <span class="n">y_index</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
                <span class="n">x_coord_string</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{x_int:d}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x_int</span><span class="o">=</span><span class="n">x_index</span><span class="p">)</span>
                <span class="n">y_coord_string</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{y_int:d}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">y_int</span><span class="o">=</span><span class="n">y_index</span><span class="p">)</span>
                <span class="c1"># Extracting the data.</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">z_float</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gui_instance</span><span class="o">.</span><span class="n">opihi_solution</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">y_index</span><span class="p">,</span> <span class="n">x_index</span><span class="p">]</span>
                <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                    <span class="c1"># There is no data to index.</span>
                    <span class="n">z_coord_string</span> <span class="o">=</span> <span class="s2">&quot;NaN&quot;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># Parse the string from the number provided.</span>
                    <span class="n">z_coord_string</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{z_flt:.2f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">z_flt</span><span class="o">=</span><span class="n">z_float</span><span class="p">)</span>

                <span class="c1"># Compiling it all together.</span>
                <span class="n">coord_string</span> <span class="o">=</span> <span class="s2">&quot;[</span><span class="si">{x_str}</span><span class="s2">, </span><span class="si">{y_str}</span><span class="s2">] = </span><span class="si">{z_str}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">x_str</span><span class="o">=</span><span class="n">x_coord_string</span><span class="p">,</span> <span class="n">y_str</span><span class="o">=</span><span class="n">y_coord_string</span><span class="p">,</span> <span class="n">z_str</span><span class="o">=</span><span class="n">z_coord_string</span>
                <span class="p">)</span>
                <span class="k">return</span> <span class="n">coord_string</span>

        <span class="c1"># Assigning the coordinate formatter derived.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_opihi_coordinate_formatter</span> <span class="o">=</span> <span class="n">CoordinateFormatter</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">opihi_axes</span><span class="o">.</span><span class="n">format_coord</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_opihi_coordinate_formatter</span>

        <span class="c1"># Setting the layout, it is likely better to have the toolbar below</span>
        <span class="c1"># rather than above to avoid conflicts with the reset buttons in the</span>
        <span class="c1"># event of a mis-click.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">vertical_layout_image</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">opihi_canvas</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">vertical_layout_image</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">opihi_nav_toolbar</span><span class="p">)</span>
        <span class="c1"># Remove the dummy spacers otherwise it is just extra unneeded space.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">vertical_layout_image</span><span class="o">.</span><span class="n">removeWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">dummy_opihi_image</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">vertical_layout_image</span><span class="o">.</span><span class="n">removeWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">dummy_opihi_navbar</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">dummy_opihi_image</span><span class="o">.</span><span class="n">hide</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">dummy_opihi_navbar</span><span class="o">.</span><span class="n">hide</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">dummy_opihi_image</span><span class="o">.</span><span class="n">deleteLater</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">dummy_opihi_navbar</span><span class="o">.</span><span class="n">deleteLater</span><span class="p">()</span>
        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">dummy_opihi_image</span>
        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">dummy_opihi_navbar</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">__init_preprocess_solution</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize the preprocessing solution. The preprocessing files</span>
<span class="sd">        should be specified in the configuration file.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Using the configuration file to extract where the preprocessing</span>
        <span class="c1"># filenames are to build the solution.</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">preprocess</span> <span class="o">=</span> <span class="n">opihiexarata</span><span class="o">.</span><span class="n">OpihiPreprocessSolution</span><span class="p">(</span>
                <span class="n">mask_c_fits_filename</span><span class="o">=</span><span class="n">library</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">PREPROCESS_MASK_C_FITS_FILENAME</span><span class="p">,</span>
                <span class="n">mask_g_fits_filename</span><span class="o">=</span><span class="n">library</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">PREPROCESS_MASK_G_FITS_FILENAME</span><span class="p">,</span>
                <span class="n">mask_r_fits_filename</span><span class="o">=</span><span class="n">library</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">PREPROCESS_MASK_R_FITS_FILENAME</span><span class="p">,</span>
                <span class="n">mask_i_fits_filename</span><span class="o">=</span><span class="n">library</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">PREPROCESS_MASK_I_FITS_FILENAME</span><span class="p">,</span>
                <span class="n">mask_z_fits_filename</span><span class="o">=</span><span class="n">library</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">PREPROCESS_MASK_Z_FITS_FILENAME</span><span class="p">,</span>
                <span class="n">mask_1_fits_filename</span><span class="o">=</span><span class="n">library</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">PREPROCESS_MASK_1_FITS_FILENAME</span><span class="p">,</span>
                <span class="n">mask_2_fits_filename</span><span class="o">=</span><span class="n">library</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">PREPROCESS_MASK_2_FITS_FILENAME</span><span class="p">,</span>
                <span class="n">mask_3_fits_filename</span><span class="o">=</span><span class="n">library</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">PREPROCESS_MASK_3_FITS_FILENAME</span><span class="p">,</span>
                <span class="n">flat_c_fits_filename</span><span class="o">=</span><span class="n">library</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">PREPROCESS_FLAT_C_FITS_FILENAME</span><span class="p">,</span>
                <span class="n">flat_g_fits_filename</span><span class="o">=</span><span class="n">library</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">PREPROCESS_FLAT_G_FITS_FILENAME</span><span class="p">,</span>
                <span class="n">flat_r_fits_filename</span><span class="o">=</span><span class="n">library</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">PREPROCESS_FLAT_R_FITS_FILENAME</span><span class="p">,</span>
                <span class="n">flat_i_fits_filename</span><span class="o">=</span><span class="n">library</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">PREPROCESS_FLAT_I_FITS_FILENAME</span><span class="p">,</span>
                <span class="n">flat_z_fits_filename</span><span class="o">=</span><span class="n">library</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">PREPROCESS_FLAT_Z_FITS_FILENAME</span><span class="p">,</span>
                <span class="n">flat_1_fits_filename</span><span class="o">=</span><span class="n">library</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">PREPROCESS_FLAT_1_FITS_FILENAME</span><span class="p">,</span>
                <span class="n">flat_2_fits_filename</span><span class="o">=</span><span class="n">library</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">PREPROCESS_FLAT_2_FITS_FILENAME</span><span class="p">,</span>
                <span class="n">flat_3_fits_filename</span><span class="o">=</span><span class="n">library</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">PREPROCESS_FLAT_3_FITS_FILENAME</span><span class="p">,</span>
                <span class="n">bias_fits_filename</span><span class="o">=</span><span class="n">library</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">PREPROCESS_BIAS_FITS_FILENAME</span><span class="p">,</span>
                <span class="n">dark_current_fits_filename</span><span class="o">=</span><span class="n">library</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">PREPROCESS_DARK_CURRENT_FITS_FILENAME</span><span class="p">,</span>
                <span class="n">linearity_fits_filename</span><span class="o">=</span><span class="n">library</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">PREPROCESS_LINEARITY_FITS_FILENAME</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="c1"># Something failed with making the preprocess solution, a</span>
            <span class="c1"># configuration file issue is likely the reason.</span>
            <span class="c1"># TODO</span>
            <span class="n">preprocess</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">preprocess_solution</span> <span class="o">=</span> <span class="n">preprocess</span>
        <span class="c1"># All done.</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">__connect_push_button_new_image_automatic</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;The automatic method relying on earliest fits file available in</span>
<span class="sd">        the expected directory. This function is a connected function action to</span>
<span class="sd">        a button in the GUI.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># TODO</span>
        <span class="n">new_fits_filename</span> <span class="o">=</span> <span class="s2">&quot;pie&quot;</span>

        <span class="c1"># If the user did not provide a file to enter, there is nothing to be</span>
        <span class="c1"># changed.</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">new_fits_filename</span><span class="p">):</span>
            <span class="c1"># Assign the new fits filename.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">raw_fits_filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">new_fits_filename</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Exit!</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="c1"># Process the file first so that what the user sees is closer to</span>
        <span class="c1"># what it really is.</span>

        <span class="c1"># Load up the new file.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_load_fits_file</span><span class="p">(</span><span class="n">fits_filename</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">raw_fits_filename</span><span class="p">)</span>
        <span class="c1"># All done.</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">__connect_push_button_new_image_manual</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;The manual method relying on earliest fits file available in</span>
<span class="sd">        the expected directory. This function is a connected function action to</span>
<span class="sd">        a button in the GUI.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Ask the user for the filename via a dialog.</span>
        <span class="n">new_fits_filename</span><span class="p">,</span> <span class="n">__</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFileDialog</span><span class="o">.</span><span class="n">getOpenFileName</span><span class="p">(</span>
            <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
            <span class="n">caption</span><span class="o">=</span><span class="s2">&quot;Open Opihi Image&quot;</span><span class="p">,</span>
            <span class="nb">dir</span><span class="o">=</span><span class="s2">&quot;./&quot;</span><span class="p">,</span>
            <span class="nb">filter</span><span class="o">=</span><span class="s2">&quot;FITS Files (*.fits)&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="c1"># If the user did not provide a file to enter, there is nothing to be</span>
        <span class="c1"># changed.</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">new_fits_filename</span><span class="p">):</span>
            <span class="c1"># Assign the new fits filename.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">raw_fits_filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">new_fits_filename</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Exit!</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="c1"># Process the file first so that what the user sees is closer to</span>
        <span class="c1"># what it really is.</span>

        <span class="c1"># Load up the new file.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_load_fits_file</span><span class="p">(</span><span class="n">fits_filename</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">raw_fits_filename</span><span class="p">)</span>
        <span class="c1"># All done.</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">__connect_push_button_new_target</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;The function serving to set the software to be on a new target.</span>
<span class="sd">        A name is prompted from the user.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Find what the new name of the target from the user.</span>
        <span class="n">previous_set_name</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">asteroid_set_name</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">asteroid_set_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="nb">str</span><span class="p">()</span>
        <span class="p">)</span>
        <span class="n">new_set_name</span> <span class="o">=</span> <span class="n">gui</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">ask_user_target_name_window</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="n">previous_set_name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">asteroid_set_name</span> <span class="o">=</span> <span class="n">new_set_name</span>

        <span class="c1"># Reset the previous text as it is all going to be a new target.</span>
        <span class="c1"># It is expected after this a new image would be selected.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clear_dynamic_label_text</span><span class="p">()</span>

        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">__connect_push_button_refresh_window</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;The function serving to refresh the window and redrawing the plot.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Just redraw the plot and redo the dynamic text.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">redraw_opihi_image</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refresh_dynamic_label_text</span><span class="p">()</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">__connect_push_button_astrometry_solve_astrometry</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;The button to instruct on the solving of the astrometric solution.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># If there is no image (and thus no solution class), there is nothing</span>
        <span class="c1"># to do.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">opihi_solution</span><span class="p">,</span> <span class="n">opihiexarata</span><span class="o">.</span><span class="n">OpihiSolution</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="c1"># Determine the engine from user input via the drop down menu. The</span>
        <span class="c1"># recognizing text ought to be case insensitive, makes life easier.</span>
        <span class="n">input_engine_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">combo_box_astrometry_solve_engine</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
        <span class="n">input_engine_name</span> <span class="o">=</span> <span class="n">input_engine_name</span><span class="o">.</span><span class="n">casefold</span><span class="p">()</span>
        <span class="c1"># Search programed engines for the one specified.</span>
        <span class="k">if</span> <span class="n">input_engine_name</span> <span class="o">==</span> <span class="s2">&quot;astrometry.net nova&quot;</span><span class="p">:</span>
            <span class="n">engine</span> <span class="o">=</span> <span class="n">astrometry</span><span class="o">.</span><span class="n">AstrometryNetWebAPIEngine</span>
            <span class="n">vehicle_args</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">error</span><span class="o">.</span><span class="n">DevelopmentError</span><span class="p">(</span>
                <span class="s2">&quot;The provided input engine name `</span><span class="si">{in_eng}</span><span class="s2">` is not implemented and&quot;</span>
                <span class="s2">&quot; cannot be matched to an implemented astrometric engine.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">in_eng</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">input_engine_name</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="p">)</span>

        <span class="c1"># Solve the field using the provided engine.</span>
        <span class="n">__</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">opihi_solution</span><span class="o">.</span><span class="n">solve_astrometry</span><span class="p">(</span>
            <span class="n">solver_engine</span><span class="o">=</span><span class="n">engine</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">vehicle_args</span><span class="o">=</span><span class="n">vehicle_args</span>
        <span class="p">)</span>
        <span class="c1"># Update all of the necessary information.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">redraw_opihi_image</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refresh_dynamic_label_text</span><span class="p">()</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">__connect_push_button_astrometry_custom_solve</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot; &quot;The button which uses an astrometric solution to solve for a</span>
<span class="sd">        custom pixel location or RA DEC location depending on entry.</span>

<span class="sd">        This prioritizes solving RA DEC from pixel location.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># If there is no astrometric solution, nothing can be done. Exit this</span>
        <span class="c1"># early.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span>
            <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">opihi_solution</span><span class="p">,</span> <span class="n">opihiexarata</span><span class="o">.</span><span class="n">OpihiSolution</span><span class="p">)</span>
            <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">opihi_solution</span><span class="o">.</span><span class="n">astrometrics</span><span class="p">,</span> <span class="n">astrometry</span><span class="o">.</span><span class="n">AstrometricSolution</span>
            <span class="p">)</span>
        <span class="p">):</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="c1"># Obtain the current values in the entry field.</span>
        <span class="n">in_custom_x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">line_edit_astrometry_custom_x</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
        <span class="n">in_custom_y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">line_edit_astrometry_custom_y</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
        <span class="n">in_custom_ra</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">line_edit_astrometry_custom_ra</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
        <span class="n">in_custom_dec</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">line_edit_astrometry_custom_dec</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>

        <span class="c1"># Prioritize the presence of the pixel location text.</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">in_custom_x</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">in_custom_y</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># Using pixel locations to determine RA DEC.</span>
            <span class="n">in_custom_x</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">in_custom_x</span><span class="p">)</span>
            <span class="n">in_custom_y</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">in_custom_y</span><span class="p">)</span>
            <span class="c1"># Reformatting the entry.</span>
            <span class="n">out_custom_x</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">in_custom_x</span><span class="p">)</span>
            <span class="n">out_custom_y</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">in_custom_y</span><span class="p">)</span>
            <span class="c1"># Converting.</span>
            <span class="p">(</span>
                <span class="n">out_custom_ra</span><span class="p">,</span>
                <span class="n">out_custom_dec</span><span class="p">,</span>
            <span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">opihi_solution</span><span class="o">.</span><span class="n">astrometrics</span><span class="o">.</span><span class="n">pixel_to_sky_coordinates</span><span class="p">(</span>
                <span class="n">x</span><span class="o">=</span><span class="n">in_custom_x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">in_custom_y</span>
            <span class="p">)</span>
            <span class="p">(</span>
                <span class="n">out_custom_ra</span><span class="p">,</span>
                <span class="n">out_custom_dec</span><span class="p">,</span>
            <span class="p">)</span> <span class="o">=</span> <span class="n">library</span><span class="o">.</span><span class="n">conversion</span><span class="o">.</span><span class="n">degrees_to_sexagesimal_ra_dec</span><span class="p">(</span>
                <span class="n">ra_deg</span><span class="o">=</span><span class="n">out_custom_ra</span><span class="p">,</span> <span class="n">dec_deg</span><span class="o">=</span><span class="n">out_custom_dec</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">in_custom_ra</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">in_custom_dec</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># Using RA DEC to solve for pixel locations.</span>
            <span class="c1"># Reformatting the entry.</span>
            <span class="n">out_custom_ra</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">in_custom_ra</span><span class="p">)</span>
            <span class="n">out_custom_dec</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">in_custom_dec</span><span class="p">)</span>

            <span class="p">(</span>
                <span class="n">in_custom_ra_deg</span><span class="p">,</span>
                <span class="n">in_custom_dec_deg</span><span class="p">,</span>
            <span class="p">)</span> <span class="o">=</span> <span class="n">library</span><span class="o">.</span><span class="n">conversion</span><span class="o">.</span><span class="n">sexagesimal_ra_dec_to_degrees</span><span class="p">(</span>
                <span class="n">ra_sex</span><span class="o">=</span><span class="n">in_custom_ra</span><span class="p">,</span> <span class="n">dec_sex</span><span class="o">=</span><span class="n">in_custom_dec</span>
            <span class="p">)</span>
            <span class="p">(</span>
                <span class="n">out_custom_x</span><span class="p">,</span>
                <span class="n">out_custom_y</span><span class="p">,</span>
            <span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">opihi_solution</span><span class="o">.</span><span class="n">astrometrics</span><span class="o">.</span><span class="n">sky_to_pixel_coordinates</span><span class="p">(</span>
                <span class="n">ra</span><span class="o">=</span><span class="n">in_custom_ra_deg</span><span class="p">,</span> <span class="n">dec</span><span class="o">=</span><span class="n">in_custom_dec_deg</span>
            <span class="p">)</span>
            <span class="c1"># Needs to be a string.</span>
            <span class="n">out_custom_x</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">out_custom_x</span><span class="p">)</span>
            <span class="n">out_custom_y</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">out_custom_y</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># No matching pair has been provided, ignore.</span>
            <span class="n">out_custom_x</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">in_custom_x</span><span class="p">)</span>
            <span class="n">out_custom_y</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">in_custom_y</span><span class="p">)</span>
            <span class="n">out_custom_ra</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">in_custom_ra</span><span class="p">)</span>
            <span class="n">out_custom_dec</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">in_custom_dec</span><span class="p">)</span>

        <span class="c1"># Finally, set the text on the values.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">line_edit_astrometry_custom_x</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">out_custom_x</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">line_edit_astrometry_custom_y</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">out_custom_y</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">line_edit_astrometry_custom_ra</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">out_custom_ra</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">line_edit_astrometry_custom_dec</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">out_custom_dec</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">__connect_push_button_photometry_solve_photometry</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;A routine to use the current observation and historical observations</span>
<span class="sd">        to derive the propagation solution.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># If there is no image (and thus no solution class), there is nothing</span>
        <span class="c1"># to do.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">opihi_solution</span><span class="p">,</span> <span class="n">opihiexarata</span><span class="o">.</span><span class="n">OpihiSolution</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="c1"># Determine the engine from user input via the drop down menu. The</span>
        <span class="c1"># recognizing text ought to be case insensitive, makes life easier.</span>
        <span class="n">input_engine_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">combo_box_photometry_solve_engine</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
        <span class="n">input_engine_name</span> <span class="o">=</span> <span class="n">input_engine_name</span><span class="o">.</span><span class="n">casefold</span><span class="p">()</span>
        <span class="c1"># Search programed engines for the one specified.</span>
        <span class="k">if</span> <span class="n">input_engine_name</span> <span class="o">==</span> <span class="s2">&quot;pan-starrs 3pi dr2 mast&quot;</span><span class="p">:</span>
            <span class="n">engine</span> <span class="o">=</span> <span class="n">photometry</span><span class="o">.</span><span class="n">PanstarrsMastWebAPIEngine</span>
            <span class="n">vehicle_args</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">error</span><span class="o">.</span><span class="n">DevelopmentError</span><span class="p">(</span>
                <span class="s2">&quot;The provided input engine name `</span><span class="si">{in_eng}</span><span class="s2">` is not implemented and&quot;</span>
                <span class="s2">&quot; cannot be matched to an implemented photometric engine.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">in_eng</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">input_engine_name</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="p">)</span>
        <span class="c1"># Solve.</span>
        <span class="n">__</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">opihi_solution</span><span class="o">.</span><span class="n">solve_photometry</span><span class="p">(</span>
            <span class="n">solver_engine</span><span class="o">=</span><span class="n">engine</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">vehicle_args</span><span class="o">=</span><span class="n">vehicle_args</span>
        <span class="p">)</span>

        <span class="c1"># Update all of the necessary information.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">redraw_opihi_image</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refresh_dynamic_label_text</span><span class="p">()</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">__connect_push_button_orbit_solve_orbit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;A routine to use the current observation and historical observations</span>
<span class="sd">        to derive the orbit solution.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># If there is no image (and thus no solution class), there is nothing</span>
        <span class="c1"># to do.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">opihi_solution</span><span class="p">,</span> <span class="n">opihiexarata</span><span class="o">.</span><span class="n">OpihiSolution</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="c1"># Determine the engine from user input via the drop down menu. The</span>
        <span class="c1"># recognizing text ought to be case insensitive, makes life easier.</span>
        <span class="n">input_engine_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">combo_box_orbit_solve_engine</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
        <span class="n">input_engine_name</span> <span class="o">=</span> <span class="n">input_engine_name</span><span class="o">.</span><span class="n">casefold</span><span class="p">()</span>
        <span class="c1"># Search programed engines for the one specified.</span>
        <span class="k">if</span> <span class="n">input_engine_name</span> <span class="o">==</span> <span class="s2">&quot;orbfit&quot;</span><span class="p">:</span>
            <span class="n">engine</span> <span class="o">=</span> <span class="n">orbit</span><span class="o">.</span><span class="n">OrbfitOrbitDeterminerEngine</span>
            <span class="n">vehicle_args</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">elif</span> <span class="n">input_engine_name</span> <span class="o">==</span> <span class="s2">&quot;custom&quot;</span><span class="p">:</span>
            <span class="n">engine</span> <span class="o">=</span> <span class="n">orbit</span><span class="o">.</span><span class="n">CustomOrbitEngine</span>
            <span class="c1"># The custom orbit requires than an orbit be specified, we</span>
            <span class="c1"># commandeer the orbital element reporting window.</span>
            <span class="n">custom_orbit_elements</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_custom_orbital_elements</span><span class="p">()</span>
            <span class="n">vehicle_args</span> <span class="o">=</span> <span class="n">custom_orbit_elements</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">error</span><span class="o">.</span><span class="n">DevelopmentError</span><span class="p">(</span>
                <span class="s2">&quot;The provided input engine name `</span><span class="si">{in_eng}</span><span class="s2">` is not implemented and&quot;</span>
                <span class="s2">&quot; cannot be matched to an implemented orbital engine.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">in_eng</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">input_engine_name</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="p">)</span>
        <span class="c1"># Solve.</span>
        <span class="n">__</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">opihi_solution</span><span class="o">.</span><span class="n">solve_orbit</span><span class="p">(</span>
            <span class="n">solver_engine</span><span class="o">=</span><span class="n">engine</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">vehicle_args</span><span class="o">=</span><span class="n">vehicle_args</span>
        <span class="p">)</span>

        <span class="c1"># Update all of the necessary information.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">redraw_opihi_image</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refresh_dynamic_label_text</span><span class="p">()</span>
        <span class="c1"># All done.</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">__connect_push_button_orbit_solve_ephemeris</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;A routine to use the current observation and historical observations</span>
<span class="sd">        to derive the orbit solution.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># If there is no image (and thus no solution class), there is nothing</span>
        <span class="c1"># to do.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">opihi_solution</span><span class="p">,</span> <span class="n">opihiexarata</span><span class="o">.</span><span class="n">OpihiSolution</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="c1"># Determine the engine from user input via the drop down menu. The</span>
        <span class="c1"># recognizing text ought to be case insensitive, makes life easier.</span>
        <span class="n">input_engine_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">combo_box_ephemeris_solve_engine</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
        <span class="n">input_engine_name</span> <span class="o">=</span> <span class="n">input_engine_name</span><span class="o">.</span><span class="n">casefold</span><span class="p">()</span>
        <span class="c1"># Search programed engines for the one specified.</span>
        <span class="k">if</span> <span class="n">input_engine_name</span> <span class="o">==</span> <span class="s2">&quot;jpl horizons&quot;</span><span class="p">:</span>
            <span class="n">engine</span> <span class="o">=</span> <span class="n">ephemeris</span><span class="o">.</span><span class="n">JPLHorizonsWebAPIEngine</span>
            <span class="n">vehicle_args</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">error</span><span class="o">.</span><span class="n">DevelopmentError</span><span class="p">(</span>
                <span class="s2">&quot;The provided input engine name `</span><span class="si">{in_eng}</span><span class="s2">` is not implemented and&quot;</span>
                <span class="s2">&quot; cannot be matched to an implemented ephemeritic engine.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">in_eng</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">input_engine_name</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="p">)</span>
        <span class="c1"># Solve.</span>
        <span class="n">__</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">opihi_solution</span><span class="o">.</span><span class="n">solve_ephemeris</span><span class="p">(</span>
            <span class="n">solver_engine</span><span class="o">=</span><span class="n">engine</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">vehicle_args</span><span class="o">=</span><span class="n">vehicle_args</span>
        <span class="p">)</span>

        <span class="c1"># Update all of the necessary information.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">redraw_opihi_image</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refresh_dynamic_label_text</span><span class="p">()</span>
        <span class="c1"># All done.</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">__connect_push_button_propagate_custom_solve</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Solving for the location of the target through the ephemeris based</span>
<span class="sd">        on the time and date provided by the user.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># If there is no propagation solution, there is nothing to be done.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">opihi_solution</span><span class="o">.</span><span class="n">ephemeritics</span><span class="p">,</span> <span class="n">ephemeris</span><span class="o">.</span><span class="n">EphemeriticSolution</span>
        <span class="p">):</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="c1"># Get the time and date from the user input.</span>
        <span class="n">datetime_input</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">date_time_edit_ephemeris_date_time</span><span class="o">.</span><span class="n">dateTime</span><span class="p">()</span>
        <span class="c1"># Getting the timezone, as the propagation requires UTC/JD time, a</span>
        <span class="c1"># conversion is needed. Qt uses IANA timezone IDs so we convert from</span>
        <span class="c1"># the human readable ones to it. We only deal with current timezones.</span>
        <span class="n">timezone_input</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">combo_box_ephemeris_timezone</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
        <span class="n">timezone_input</span> <span class="o">=</span> <span class="n">timezone_input</span><span class="o">.</span><span class="n">casefold</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">timezone_input</span> <span class="o">==</span> <span class="s2">&quot;utc+00:00&quot;</span><span class="p">:</span>
            <span class="n">qt_timezone_str</span> <span class="o">=</span> <span class="s2">&quot;Etc/UTC&quot;</span>
        <span class="k">elif</span> <span class="n">timezone_input</span> <span class="o">==</span> <span class="s2">&quot;hst-10:00&quot;</span><span class="p">:</span>
            <span class="n">qt_timezone_str</span> <span class="o">=</span> <span class="s2">&quot;Pacific/Honolulu&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">error</span><span class="o">.</span><span class="n">DevelopmentError</span><span class="p">(</span>
                <span class="s2">&quot;The timezone dropdown entry provided by the GUI is not implemented and&quot;</span>
                <span class="s2">&quot; has no translation to an IANA timezone ID.&quot;</span>
            <span class="p">)</span>

        <span class="c1"># Using Qt&#39;s own datetime conversion just because it is already here.</span>
        <span class="n">qt_timezone_bytearray</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QByteArray</span><span class="p">(</span><span class="n">qt_timezone_str</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span>
        <span class="n">qt_timezone</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QTimeZone</span><span class="p">(</span><span class="n">qt_timezone_bytearray</span><span class="p">)</span>
        <span class="n">datetime_input</span><span class="o">.</span><span class="n">setTimeZone</span><span class="p">(</span><span class="n">qt_timezone</span><span class="p">)</span>
        <span class="n">unix_time_input</span> <span class="o">=</span> <span class="n">datetime_input</span><span class="o">.</span><span class="n">toSecsSinceEpoch</span><span class="p">()</span>
        <span class="c1"># As a Julian day as that is the standard time system.</span>
        <span class="n">julian_day_input</span> <span class="o">=</span> <span class="n">library</span><span class="o">.</span><span class="n">conversion</span><span class="o">.</span><span class="n">unix_time_to_julian_day</span><span class="p">(</span>
            <span class="n">unix_time</span><span class="o">=</span><span class="n">unix_time_input</span>
        <span class="p">)</span>

        <span class="c1"># Using this unique time provided to solve the propagation.</span>
        <span class="n">ra_deg</span><span class="p">,</span> <span class="n">dec_deg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">opihi_solution</span><span class="o">.</span><span class="n">ephemeritics</span><span class="o">.</span><span class="n">forward_ephemeris</span><span class="p">(</span>
            <span class="n">future_time</span><span class="o">=</span><span class="n">julian_day_input</span>
        <span class="p">)</span>
        <span class="n">ra_sex</span><span class="p">,</span> <span class="n">dec_sex</span> <span class="o">=</span> <span class="n">library</span><span class="o">.</span><span class="n">conversion</span><span class="o">.</span><span class="n">degrees_to_sexagesimal_ra_dec</span><span class="p">(</span>
            <span class="n">ra_deg</span><span class="o">=</span><span class="n">ra_deg</span><span class="p">,</span> <span class="n">dec_deg</span><span class="o">=</span><span class="n">dec_deg</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span>
        <span class="p">)</span>
        <span class="c1"># Updating the RA and DEC values.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">label_dynamic_ephemeris_custom_ra</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">ra_sex</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">label_dynamic_ephemeris_custom_dec</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">dec_sex</span><span class="p">)</span>

        <span class="c1"># All done.</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">__connect_push_button_propagate_solve_propagation</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;A routine to use the current observation and historical observations</span>
<span class="sd">        to derive the propagation solution.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># If there is no image (and thus no solution class), there is nothing</span>
        <span class="c1"># to do.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">opihi_solution</span><span class="p">,</span> <span class="n">opihiexarata</span><span class="o">.</span><span class="n">OpihiSolution</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="c1"># Determine the engine from user input via the drop down menu. The</span>
        <span class="c1"># recognizing text ought to be case insensitive, makes life easier.</span>
        <span class="n">input_engine_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">combo_box_propagate_solve_engine</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
        <span class="n">input_engine_name</span> <span class="o">=</span> <span class="n">input_engine_name</span><span class="o">.</span><span class="n">casefold</span><span class="p">()</span>
        <span class="c1"># Search programed engines for the one specified.</span>
        <span class="k">if</span> <span class="n">input_engine_name</span> <span class="o">==</span> <span class="s2">&quot;linear&quot;</span><span class="p">:</span>
            <span class="n">engine</span> <span class="o">=</span> <span class="n">propagate</span><span class="o">.</span><span class="n">LinearPropagationEngine</span>
            <span class="n">vehicle_args</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">elif</span> <span class="n">input_engine_name</span> <span class="o">==</span> <span class="s2">&quot;quadratic&quot;</span><span class="p">:</span>
            <span class="n">engine</span> <span class="o">=</span> <span class="n">propagate</span><span class="o">.</span><span class="n">QuadraticPropagationEngine</span>
            <span class="n">vehicle_args</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">error</span><span class="o">.</span><span class="n">DevelopmentError</span><span class="p">(</span>
                <span class="s2">&quot;The provided input engine name `</span><span class="si">{in_eng}</span><span class="s2">` is not implemented and&quot;</span>
                <span class="s2">&quot; cannot be matched to an implemented propagative engine.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">in_eng</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">input_engine_name</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="p">)</span>
        <span class="c1"># Solve.</span>
        <span class="n">__</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">opihi_solution</span><span class="o">.</span><span class="n">solve_propagate</span><span class="p">(</span>
            <span class="n">solver_engine</span><span class="o">=</span><span class="n">engine</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">vehicle_args</span><span class="o">=</span><span class="n">vehicle_args</span>
        <span class="p">)</span>

        <span class="c1"># Update all of the necessary information.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">redraw_opihi_image</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refresh_dynamic_label_text</span><span class="p">()</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">__connect_push_button_propagate_custom_solve</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Solving for the location of the target through propagation based on</span>
<span class="sd">        the time and date provided by the user.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># If there is no propagation solution, there is nothing to be done.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">opihi_solution</span><span class="o">.</span><span class="n">propagatives</span><span class="p">,</span> <span class="n">propagate</span><span class="o">.</span><span class="n">PropagativeSolution</span>
        <span class="p">):</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="c1"># Get the time and date from the user input.</span>
        <span class="n">datetime_input</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">date_time_edit_propagate_date_time</span><span class="o">.</span><span class="n">dateTime</span><span class="p">()</span>
        <span class="c1"># Getting the timezone, as the propagation requires UTC/JD time, a</span>
        <span class="c1"># conversion is needed. Qt uses IANA timezone IDs so we convert from</span>
        <span class="c1"># the human readable ones to it. We only deal with current timezones.</span>
        <span class="n">timezone_input</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">combo_box_propagate_timezone</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
        <span class="n">timezone_input</span> <span class="o">=</span> <span class="n">timezone_input</span><span class="o">.</span><span class="n">casefold</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">timezone_input</span> <span class="o">==</span> <span class="s2">&quot;utc+00:00&quot;</span><span class="p">:</span>
            <span class="n">qt_timezone_str</span> <span class="o">=</span> <span class="s2">&quot;Etc/UTC&quot;</span>
        <span class="k">elif</span> <span class="n">timezone_input</span> <span class="o">==</span> <span class="s2">&quot;hst-10:00&quot;</span><span class="p">:</span>
            <span class="n">qt_timezone_str</span> <span class="o">=</span> <span class="s2">&quot;Pacific/Honolulu&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">error</span><span class="o">.</span><span class="n">DevelopmentError</span><span class="p">(</span>
                <span class="s2">&quot;The timezone dropdown entry provided by the GUI is not implemented and&quot;</span>
                <span class="s2">&quot; has no translation to an IANA timezone ID.&quot;</span>
            <span class="p">)</span>

        <span class="c1"># Using Qt&#39;s own datetime conversion just because it is already here.</span>
        <span class="n">qt_timezone_bytearray</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QByteArray</span><span class="p">(</span><span class="n">qt_timezone_str</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span>
        <span class="n">qt_timezone</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QTimeZone</span><span class="p">(</span><span class="n">qt_timezone_bytearray</span><span class="p">)</span>
        <span class="n">datetime_input</span><span class="o">.</span><span class="n">setTimeZone</span><span class="p">(</span><span class="n">qt_timezone</span><span class="p">)</span>
        <span class="n">unix_time_input</span> <span class="o">=</span> <span class="n">datetime_input</span><span class="o">.</span><span class="n">toSecsSinceEpoch</span><span class="p">()</span>
        <span class="c1"># As a Julian day as that is the standard time system.</span>
        <span class="n">julian_day_input</span> <span class="o">=</span> <span class="n">library</span><span class="o">.</span><span class="n">conversion</span><span class="o">.</span><span class="n">unix_time_to_julian_day</span><span class="p">(</span>
            <span class="n">unix_time</span><span class="o">=</span><span class="n">unix_time_input</span>
        <span class="p">)</span>

        <span class="c1"># Using this unique time provided to solve the propagation.</span>
        <span class="n">ra_deg</span><span class="p">,</span> <span class="n">dec_deg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">opihi_solution</span><span class="o">.</span><span class="n">propagatives</span><span class="o">.</span><span class="n">forward_propagate</span><span class="p">(</span>
            <span class="n">future_time</span><span class="o">=</span><span class="n">julian_day_input</span>
        <span class="p">)</span>
        <span class="n">ra_sex</span><span class="p">,</span> <span class="n">dec_sex</span> <span class="o">=</span> <span class="n">library</span><span class="o">.</span><span class="n">conversion</span><span class="o">.</span><span class="n">degrees_to_sexagesimal_ra_dec</span><span class="p">(</span>
            <span class="n">ra_deg</span><span class="o">=</span><span class="n">ra_deg</span><span class="p">,</span> <span class="n">dec_deg</span><span class="o">=</span><span class="n">dec_deg</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span>
        <span class="p">)</span>
        <span class="c1"># Updating the RA and DEC values.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">label_dynamic_propagate_custom_ra</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">ra_sex</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">label_dynamic_propagate_custom_dec</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">dec_sex</span><span class="p">)</span>

        <span class="c1"># All done.</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">__get_mpc_record_filename</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;This is a function which derives the MPC record filename from</span>
<span class="sd">        naming conventions and the current fits file name.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        mpc_record_filename : str</span>
<span class="sd">            The filename of the MPC record for this object/image.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">mpc_target_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">asteroid_set_name</span>
        <span class="n">mpc_record_filename</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{an}</span><span class="s2">__exarata_mpcrecord&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">an</span><span class="o">=</span><span class="n">mpc_target_name</span><span class="p">)</span>
        <span class="c1"># Search the same directory as the fits file for this information as</span>
        <span class="c1"># that is currently the expected location.</span>
        <span class="c1"># Preferring the preprocessed filename if it exists, have a fall back.</span>
        <span class="n">fits_pathname</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">raw_fits_filename</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">process_fits_filename</span> <span class="ow">is</span> <span class="kc">None</span>
            <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">process_fits_filename</span>
        <span class="p">)</span>
        <span class="n">fits_directory</span> <span class="o">=</span> <span class="n">library</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">get_directory</span><span class="p">(</span><span class="n">pathname</span><span class="o">=</span><span class="n">fits_pathname</span><span class="p">)</span>
        <span class="n">mpc_record_filename</span> <span class="o">=</span> <span class="n">library</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">merge_pathname</span><span class="p">(</span>
            <span class="n">directory</span><span class="o">=</span><span class="n">fits_directory</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="n">mpc_record_filename</span><span class="p">,</span> <span class="n">extension</span><span class="o">=</span><span class="s2">&quot;txt&quot;</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">mpc_record_filename</span>

<div class="viewcode-block" id="OpihiManualWindow._preprocess_fits_file"><a class="viewcode-back" href="../../../code/opihiexarata.gui.manual.html#opihiexarata.gui.manual.OpihiManualWindow._preprocess_fits_file">[docs]</a>    <span class="k">def</span> <span class="nf">_preprocess_fits_file</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">raw_filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">process_filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Using the provided filename, preprocess the fits file listed.</span>

<span class="sd">        This is used primarily during the loading of a new fits file.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        raw_filename : string</span>
<span class="sd">            The filename of the raw fits file to be preprocessed.</span>
<span class="sd">        process_filename : string, default = None</span>
<span class="sd">            The filename where the processed fits file will be saved to. If</span>
<span class="sd">            None, it defaults to a sensible naming convention to distinguish</span>
<span class="sd">            the two.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        process_filename : string</span>
<span class="sd">            The filename of the preprocessed file is returned, this is just</span>
<span class="sd">            in case the value was derived from the naming convention. This is</span>
<span class="sd">            an absolute path.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Deriving saving location of the processed fits file.</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">process_filename</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">process_filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">process_filename</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Use a sensible naming convention to distinguish between the raw</span>
            <span class="c1"># and processed file.</span>
            <span class="c1"># TODO</span>
            <span class="n">process_filename</span> <span class="o">=</span> <span class="s2">&quot;./process.fits&quot;</span>

        <span class="c1"># Saving for later.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">process_fits_filename</span> <span class="o">=</span> <span class="n">process_filename</span>

        <span class="c1"># Process the fits file.</span>
        <span class="n">__</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">preprocess_solution</span><span class="o">.</span><span class="n">preprocess_fits_file</span><span class="p">(</span>
            <span class="n">raw_filename</span><span class="o">=</span><span class="n">raw_filename</span><span class="p">,</span> <span class="n">out_filename</span><span class="o">=</span><span class="n">process_filename</span>
        <span class="p">)</span>
        <span class="c1"># All done.</span>
        <span class="k">return</span> <span class="n">process_filename</span></div>

<div class="viewcode-block" id="OpihiManualWindow._load_fits_file"><a class="viewcode-back" href="../../../code/opihiexarata.gui.manual.html#opihiexarata.gui.manual.OpihiManualWindow._load_fits_file">[docs]</a>    <span class="k">def</span> <span class="nf">_load_fits_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fits_filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Load a fits file into the GUI to derive all of the solutions needed.</span>

<span class="sd">        This loads the fits file into an OpihiSolution class for which this</span>
<span class="sd">        GUI interacts with and derives the information from.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        fits_filename : str</span>
<span class="sd">            The fits filename which will be loaded.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Saving the previous file and other information.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save_results</span><span class="p">()</span>

        <span class="c1"># Extracting the header of this fits file to get the observing</span>
        <span class="c1"># metadata from it.</span>
        <span class="n">header</span><span class="p">,</span> <span class="n">__</span> <span class="o">=</span> <span class="n">library</span><span class="o">.</span><span class="n">fits</span><span class="o">.</span><span class="n">read_fits_image_file</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">fits_filename</span><span class="p">)</span>

        <span class="c1"># The filter which image is in, extracted from the fits file,</span>
        <span class="c1"># assuming standard form.</span>
        <span class="n">filter_name</span> <span class="o">=</span> <span class="s2">&quot;g&quot;</span>

        <span class="c1"># The exposure time of the image, extracted from the fits file,</span>
        <span class="c1"># assuming standard form.</span>
        <span class="n">exposure_time</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">header</span><span class="p">[</span><span class="s2">&quot;ITIME&quot;</span><span class="p">])</span>

        <span class="c1"># Converting date to Julian day as the solution class requires it.</span>
        <span class="c1"># We use the modified Julian day from the header file.</span>
        <span class="n">observing_time</span> <span class="o">=</span> <span class="n">library</span><span class="o">.</span><span class="n">conversion</span><span class="o">.</span><span class="n">modified_julian_day_to_julian_day</span><span class="p">(</span>
            <span class="n">mjd</span><span class="o">=</span><span class="n">header</span><span class="p">[</span><span class="s2">&quot;MJD_OBS&quot;</span><span class="p">]</span>
        <span class="p">)</span>

        <span class="c1"># For asteroid information, if we are to prompt the user for</span>
        <span class="c1"># information about the asteroid.</span>
        <span class="k">if</span> <span class="n">library</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">GUI_PROMPT_FOR_ASTEROID_INFORMATION</span><span class="p">:</span>
            <span class="c1"># The name is derived from the current object set that we are on.</span>
            <span class="n">asteroid_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">asteroid_set_name</span>
            <span class="c1"># Use the target selector GUI for the position of the asteroid.</span>
            <span class="n">asteroid_location</span> <span class="o">=</span> <span class="n">gui</span><span class="o">.</span><span class="n">selector</span><span class="o">.</span><span class="n">ask_user_target_selector_window</span><span class="p">(</span>
                <span class="n">current_fits_filename</span><span class="o">=</span><span class="n">fits_filename</span>
            <span class="p">)</span>
            <span class="c1"># If there exists a MPC record of previous observations, use it</span>
            <span class="c1"># for the history. If it does not exist, make one.</span>
            <span class="n">mpcrecord_filename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_mpc_record_filename</span><span class="p">()</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">mpcrecord_filename</span><span class="p">):</span>
                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">mpcrecord_filename</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">):</span>
                    <span class="k">pass</span>
            <span class="c1"># Read the historical data.</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">mpcrecord_filename</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">mpcfile</span><span class="p">:</span>
                <span class="n">raw_lines</span> <span class="o">=</span> <span class="n">mpcfile</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
            <span class="c1"># The files have new line characters on them, they need to be</span>
            <span class="c1"># removed to have the normal 80 characters.</span>
            <span class="n">asteroid_history</span> <span class="o">=</span> <span class="p">[</span><span class="n">linedex</span><span class="o">.</span><span class="n">removesuffix</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">linedex</span> <span class="ow">in</span> <span class="n">raw_lines</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">asteroid_name</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">asteroid_location</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">asteroid_history</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># Although the OpihiSolution could derive these values from the</span>
        <span class="c1"># header of the filename, the solution class is built to be general.</span>
        <span class="c1"># Creating the solution from the data.</span>
        <span class="n">opihi_solution</span> <span class="o">=</span> <span class="n">opihiexarata</span><span class="o">.</span><span class="n">OpihiSolution</span><span class="p">(</span>
            <span class="n">fits_filename</span><span class="o">=</span><span class="n">fits_filename</span><span class="p">,</span>
            <span class="n">filter_name</span><span class="o">=</span><span class="n">filter_name</span><span class="p">,</span>
            <span class="n">exposure_time</span><span class="o">=</span><span class="n">exposure_time</span><span class="p">,</span>
            <span class="n">observing_time</span><span class="o">=</span><span class="n">observing_time</span><span class="p">,</span>
            <span class="n">asteroid_name</span><span class="o">=</span><span class="n">asteroid_name</span><span class="p">,</span>
            <span class="n">asteroid_location</span><span class="o">=</span><span class="n">asteroid_location</span><span class="p">,</span>
            <span class="n">asteroid_history</span><span class="o">=</span><span class="n">asteroid_history</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">opihi_solution</span> <span class="o">=</span> <span class="n">opihi_solution</span>

        <span class="c1"># Because a new image was loaded, the previous values and other</span>
        <span class="c1"># information derived from the last image are invalid, reset and replot.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clear_dynamic_label_text</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refresh_dynamic_label_text</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">redraw_opihi_image</span><span class="p">()</span>
        <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="OpihiManualWindow._parse_custom_orbital_elements"><a class="viewcode-back" href="../../../code/opihiexarata.gui.manual.html#opihiexarata.gui.manual.OpihiManualWindow._parse_custom_orbital_elements">[docs]</a>    <span class="k">def</span> <span class="nf">_parse_custom_orbital_elements</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;This function takes the textual form of the orbital elements as</span>
<span class="sd">        entered and tries to parse it into a set of orbital elements and errors.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        orbital_elements : dictionary</span>
<span class="sd">            A dictionary of the orbital elements and their errors, if they</span>
<span class="sd">            exist.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Extracting all of the values from the text.</span>
        <span class="n">sm_axis_str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">line_edit_orbit_semimajor_axis</span><span class="o">.</span><span class="n">text</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="n">ecc_str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">line_edit_orbit_eccentricity</span><span class="o">.</span><span class="n">text</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="n">incli_str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">line_edit_orbit_inclination</span><span class="o">.</span><span class="n">text</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="n">as_node_str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">line_edit_orbit_ascending_node</span><span class="o">.</span><span class="n">text</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="n">peri_str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">line_edit_orbit_perihelion</span><span class="o">.</span><span class="n">text</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="n">m_anom_str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">line_edit_orbit_mean_anomaly</span><span class="o">.</span><span class="n">text</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="n">epoch_str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">line_edit_orbit_epoch</span><span class="o">.</span><span class="n">text</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

        <span class="c1"># Parse if there is an error bar or not. Writing a function because</span>
        <span class="c1"># this is going to be happening a lot.</span>
        <span class="k">def</span> <span class="nf">error_bar_parse</span><span class="p">(</span><span class="n">entry_string</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
            <span class="sd">&quot;&quot;&quot;The deliminator for an error bar is any non numeric or decimal</span>
<span class="sd">            marker.&quot;&quot;&quot;</span>
            <span class="n">entry_string</span> <span class="o">=</span> <span class="n">entry_string</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="n">non_demlim_marks</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="s2">&quot;1234567890.,&quot;</span><span class="p">)</span>
            <span class="c1"># In the event there are more than one character acting as</span>
            <span class="c1"># a deliminator.</span>
            <span class="n">lower_delim_index</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">upper_delim_index</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">chardex</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">entry_string</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">chardex</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">non_demlim_marks</span><span class="p">:</span>
                    <span class="c1"># This character is a deliminator, mark it.</span>
                    <span class="k">if</span> <span class="n">lower_delim_index</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="c1"># This is the first time a deliminator character has</span>
                        <span class="c1"># been encountered.</span>
                        <span class="n">lower_delim_index</span> <span class="o">=</span> <span class="n">index</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="c1"># Other deliminator characters have been encountered so</span>
                        <span class="c1"># this is the last known deliminator.</span>
                        <span class="n">upper_delim_index</span> <span class="o">=</span> <span class="n">index</span>
            <span class="c1"># Split the string based on the deliminator for the value and</span>
            <span class="c1"># error segment.</span>
            <span class="k">if</span> <span class="n">lower_delim_index</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">upper_delim_index</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="c1"># There was never a deliminator, there is only one value and</span>
                <span class="c1"># no error bars.</span>
                <span class="n">value_number</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">entry_string</span><span class="p">)</span>
                <span class="n">error_number</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
            <span class="k">elif</span> <span class="n">lower_delim_index</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">upper_delim_index</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="c1"># There is only one deliminator character, use this to split</span>
                <span class="c1"># the string.</span>
                <span class="n">value_string</span> <span class="o">=</span> <span class="n">entry_string</span><span class="p">[:</span><span class="n">lower_delim_index</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                <span class="n">error_string</span> <span class="o">=</span> <span class="n">entry_string</span><span class="p">[</span><span class="n">lower_delim_index</span><span class="p">:]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                <span class="c1"># Converting to values.</span>
                <span class="n">value_number</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">value_string</span><span class="p">)</span>
                <span class="n">error_number</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">error_string</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">lower_delim_index</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">upper_delim_index</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="c1"># There are more than one characters for the deliminator.</span>
                <span class="n">value_string</span> <span class="o">=</span> <span class="n">entry_string</span><span class="p">[:</span><span class="n">lower_delim_index</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                <span class="n">error_string</span> <span class="o">=</span> <span class="n">entry_string</span><span class="p">[</span><span class="n">upper_delim_index</span><span class="p">:]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                <span class="c1"># Converting to values.</span>
                <span class="n">value_number</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">value_string</span><span class="p">)</span>
                <span class="n">error_number</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">error_string</span><span class="p">)</span>
            <span class="c1"># All done.</span>
            <span class="k">return</span> <span class="n">value_number</span><span class="p">,</span> <span class="n">error_number</span>

        <span class="c1"># Parsing the strings.</span>
        <span class="n">sm_axis_val</span><span class="p">,</span> <span class="n">sm_axis_err</span> <span class="o">=</span> <span class="n">error_bar_parse</span><span class="p">(</span><span class="n">sm_axis_str</span><span class="p">)</span>
        <span class="n">ecc_val</span><span class="p">,</span> <span class="n">ecc_err</span> <span class="o">=</span> <span class="n">error_bar_parse</span><span class="p">(</span><span class="n">ecc_str</span><span class="p">)</span>
        <span class="n">incli_val</span><span class="p">,</span> <span class="n">incli_err</span> <span class="o">=</span> <span class="n">error_bar_parse</span><span class="p">(</span><span class="n">incli_str</span><span class="p">)</span>
        <span class="n">as_node_val</span><span class="p">,</span> <span class="n">as_node_err</span> <span class="o">=</span> <span class="n">error_bar_parse</span><span class="p">(</span><span class="n">as_node_str</span><span class="p">)</span>
        <span class="n">peri_val</span><span class="p">,</span> <span class="n">peri_err</span> <span class="o">=</span> <span class="n">error_bar_parse</span><span class="p">(</span><span class="n">peri_str</span><span class="p">)</span>
        <span class="n">m_anom_val</span><span class="p">,</span> <span class="n">m_anom_err</span> <span class="o">=</span> <span class="n">error_bar_parse</span><span class="p">(</span><span class="n">m_anom_str</span><span class="p">)</span>
        <span class="n">epoch_val</span><span class="p">,</span> <span class="n">epoch_err</span> <span class="o">=</span> <span class="n">error_bar_parse</span><span class="p">(</span><span class="n">epoch_str</span><span class="p">)</span>
        <span class="c1"># The Epoch should not have an error.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">epoch_err</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">error</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span>
                <span class="s2">&quot;The Epoch value is detecting that it is specified with an error term&quot;</span>
                <span class="s2">&quot; with a non-numeric deliminator. However, the Epoch should not have an&quot;</span>
                <span class="s2">&quot; error specified.&quot;</span>
            <span class="p">)</span>
        <span class="c1"># The orbital element dictionary which would be used for a custom</span>
        <span class="c1"># orbit.</span>
        <span class="n">orbital_elements</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;semimajor_axis&quot;</span><span class="p">:</span> <span class="n">sm_axis_val</span><span class="p">,</span>
            <span class="s2">&quot;semimajor_axis_error&quot;</span><span class="p">:</span> <span class="n">sm_axis_err</span><span class="p">,</span>
            <span class="s2">&quot;eccentricity&quot;</span><span class="p">:</span> <span class="n">ecc_val</span><span class="p">,</span>
            <span class="s2">&quot;eccentricity_error&quot;</span><span class="p">:</span> <span class="n">ecc_err</span><span class="p">,</span>
            <span class="s2">&quot;inclination&quot;</span><span class="p">:</span> <span class="n">incli_val</span><span class="p">,</span>
            <span class="s2">&quot;inclination_error&quot;</span><span class="p">:</span> <span class="n">incli_err</span><span class="p">,</span>
            <span class="s2">&quot;longitude_ascending_node&quot;</span><span class="p">:</span> <span class="n">as_node_val</span><span class="p">,</span>
            <span class="s2">&quot;longitude_ascending_node_error&quot;</span><span class="p">:</span> <span class="n">as_node_err</span><span class="p">,</span>
            <span class="s2">&quot;argument_perihelion&quot;</span><span class="p">:</span> <span class="n">peri_val</span><span class="p">,</span>
            <span class="s2">&quot;argument_perihelion_error&quot;</span><span class="p">:</span> <span class="n">peri_err</span><span class="p">,</span>
            <span class="s2">&quot;mean_anomaly&quot;</span><span class="p">:</span> <span class="n">m_anom_val</span><span class="p">,</span>
            <span class="s2">&quot;mean_anomaly_error&quot;</span><span class="p">:</span> <span class="n">m_anom_err</span><span class="p">,</span>
            <span class="s2">&quot;epoch_julian_day&quot;</span><span class="p">:</span> <span class="n">epoch_val</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="c1"># All done.</span>
        <span class="k">return</span> <span class="n">orbital_elements</span></div>

<div class="viewcode-block" id="OpihiManualWindow.clear_dynamic_label_text"><a class="viewcode-back" href="../../../code/opihiexarata.gui.manual.html#opihiexarata.gui.manual.OpihiManualWindow.clear_dynamic_label_text">[docs]</a>    <span class="k">def</span> <span class="nf">clear_dynamic_label_text</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Clear all of the dynamic label text and other related fields,</span>
<span class="sd">        this is traditionally done just before a new image is going to be</span>
<span class="sd">        introduced.</span>

<span class="sd">        This resets the text back to their defaults as per the GUI builder.</span>

<span class="sd">        The selections on the engines do not need to be reset as they are</span>
<span class="sd">        just a selection criteria and do not actually provide any information.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">## Resetting Summary information.</span>
        <span class="c1">#####</span>

        <span class="c1">## Resetting Astrometry information.</span>
        <span class="c1">#####</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">label_dynamic_astrometry_center_x</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;0000&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">label_dynamic_astrometry_center_y</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;0000&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">label_dynamic_astrometry_center_ra</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;HH:MM:SS.SS&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">label_dynamic_astrometry_center_dec</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;+DD:MM:SS.SS&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">label_dynamic_astrometry_target_x</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;0000&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">label_dynamic_astrometry_target_y</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;0000&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">label_dynamic_astrometry_target_ra</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;HH:MM:SS.SS&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">label_dynamic_astrometry_target_dec</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;+DD:MM:SS.SS&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">line_edit_astrometry_custom_x</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">line_edit_astrometry_custom_y</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">line_edit_astrometry_custom_ra</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">line_edit_astrometry_custom_dec</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

        <span class="c1">## Resetting Photometric information.</span>
        <span class="c1">#####</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">label_dynamic_photometry_filter_name</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;FF&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">label_dynamic_photometry_zero_point_value</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;ZZ.ZZ + E.EEE&quot;</span><span class="p">)</span>

        <span class="c1">## Resetting Orbit information.</span>
        <span class="c1">#####</span>

        <span class="c1">## Resetting Ephemeris information.</span>
        <span class="c1">#####</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">label_dynamic_ephemeris_ra_velocity</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;+VV.VVV&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">label_dynamic_ephemeris_dec_velocity</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;+VV.VVV&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">label_dynamic_ephemeris_ra_acceleration</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;+AA.AAAeXX&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">label_dynamic_ephemeris_dec_acceleration</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;+AA.AAAeXX&quot;</span><span class="p">)</span>

        <span class="c1">## Resetting Propagate information.</span>
        <span class="c1">#####</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">label_dynamic_propagate_ra_velocity</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;+VV.VVV&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">label_dynamic_propagate_dec_velocity</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;+VV.VVV&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">label_dynamic_propagate_ra_acceleration</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;+AA.AAAeXX&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">label_dynamic_propagate_dec_acceleration</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;+AA.AAAeXX&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">text_browser_propagate_future_results</span><span class="o">.</span><span class="n">setPlainText</span><span class="p">(</span>
            <span class="s2">&quot;YYYY-MM-DD  HH:MM:SS  Z   |   HH:MM:SS.SS    +DD:MM:SS.SS&quot;</span>
        <span class="p">)</span>
        <span class="c1"># Keeping the timezone and time information for convenience.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">label_dynamic_propagate_custom_ra</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;HH:MM:SS.SS&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">label_dynamic_propagate_custom_dec</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;+DD:MM:SS.SS&quot;</span><span class="p">)</span>

        <span class="c1"># All done.</span>
        <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="OpihiManualWindow.refresh_dynamic_label_text"><a class="viewcode-back" href="../../../code/opihiexarata.gui.manual.html#opihiexarata.gui.manual.OpihiManualWindow.refresh_dynamic_label_text">[docs]</a>    <span class="k">def</span> <span class="nf">refresh_dynamic_label_text</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Refresh all of the dynamic label text, this fills out the</span>
<span class="sd">        information based on the current solutions available and solved.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># These values are only to be done if the OpihiSolution actually</span>
        <span class="c1"># exists, otherwise, there is nothing to update in the text.</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">opihi_solution</span><span class="p">,</span> <span class="n">opihiexarata</span><span class="o">.</span><span class="n">OpihiSolution</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__refresh_dynamic_label_text_astrometry</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__refresh_dynamic_label_text_photometry</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__refresh_dynamic_label_text_orbit</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__refresh_dynamic_label_text_ephemeris</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__refresh_dynamic_label_text_propagate</span><span class="p">()</span>

        <span class="c1"># All done.</span>
        <span class="k">return</span> <span class="kc">None</span></div>

    <span class="k">def</span> <span class="nf">__refresh_dynamic_label_text_astrometry</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Refresh all of the dynamic label text for astrometry.</span>
<span class="sd">        This fills out the information based on the current solutions</span>
<span class="sd">        available and solved.</span>

<span class="sd">        An astrometric solution must exist.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Everything in this function needs the OpihiSolution, if it does not</span>
        <span class="c1"># exist, then exit early as there is nothing to refresh.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">opihi_solution</span><span class="p">,</span> <span class="n">opihiexarata</span><span class="o">.</span><span class="n">OpihiSolution</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">opihi_solution</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">opihi_solution</span>

        <span class="c1"># The pixel center location of the image and the pixel location of</span>
        <span class="c1"># the asteroid does not require the astrometric solution.</span>
        <span class="n">cen_x</span><span class="p">,</span> <span class="n">cen_y</span> <span class="o">=</span> <span class="p">[</span><span class="n">side</span> <span class="o">/</span> <span class="mi">2</span> <span class="k">for</span> <span class="n">side</span> <span class="ow">in</span> <span class="n">opihi_solution</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">]</span>
        <span class="n">trg_x</span><span class="p">,</span> <span class="n">trg_y</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">opihi_solution</span><span class="o">.</span><span class="n">asteroid_location</span>
            <span class="k">if</span> <span class="n">opihi_solution</span><span class="o">.</span><span class="n">asteroid_location</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="k">else</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="c1"># Replace the text with the new information.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">label_dynamic_astrometry_center_x</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">cen_x</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">label_dynamic_astrometry_center_y</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">cen_y</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">label_dynamic_astrometry_target_x</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">trg_x</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">label_dynamic_astrometry_target_y</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">trg_y</span><span class="p">))</span>

        <span class="c1"># Everything beyond this point requires an astrometric solution, if</span>
        <span class="c1"># it does not exist, there is no point in continuing, exiting early.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">opihi_solution</span><span class="o">.</span><span class="n">astrometrics</span><span class="p">,</span> <span class="n">astrometry</span><span class="o">.</span><span class="n">AstrometricSolution</span>
        <span class="p">):</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">astrometrics</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">opihi_solution</span><span class="o">.</span><span class="n">astrometrics</span>

        <span class="c1"># The pixel locations converted to RA DEC via the astrometric solution.</span>
        <span class="n">cen_ra</span><span class="p">,</span> <span class="n">cen_dec</span> <span class="o">=</span> <span class="n">astrometrics</span><span class="o">.</span><span class="n">pixel_to_sky_coordinates</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">cen_x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">cen_y</span><span class="p">)</span>
        <span class="n">trg_ra</span><span class="p">,</span> <span class="n">trg_dec</span> <span class="o">=</span> <span class="n">astrometrics</span><span class="o">.</span><span class="n">pixel_to_sky_coordinates</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">trg_x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">trg_y</span><span class="p">)</span>

        <span class="c1"># The format really ought to be in HMSDMS hexadecimal-like as it</span>
        <span class="c1"># is more familiar to Astronomers.</span>
        <span class="n">cen_ra_sex</span><span class="p">,</span> <span class="n">cen_dec_sex</span> <span class="o">=</span> <span class="n">library</span><span class="o">.</span><span class="n">conversion</span><span class="o">.</span><span class="n">degrees_to_sexagesimal_ra_dec</span><span class="p">(</span>
            <span class="n">ra_deg</span><span class="o">=</span><span class="n">cen_ra</span><span class="p">,</span> <span class="n">dec_deg</span><span class="o">=</span><span class="n">cen_dec</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span>
        <span class="p">)</span>
        <span class="n">trg_ra_sex</span><span class="p">,</span> <span class="n">trg_dec_sex</span> <span class="o">=</span> <span class="n">library</span><span class="o">.</span><span class="n">conversion</span><span class="o">.</span><span class="n">degrees_to_sexagesimal_ra_dec</span><span class="p">(</span>
            <span class="n">ra_deg</span><span class="o">=</span><span class="n">trg_ra</span><span class="p">,</span> <span class="n">dec_deg</span><span class="o">=</span><span class="n">trg_dec</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span>
        <span class="p">)</span>
        <span class="c1"># Replace the text.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">label_dynamic_astrometry_center_ra</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">cen_ra_sex</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">label_dynamic_astrometry_center_dec</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">cen_dec_sex</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">label_dynamic_astrometry_target_ra</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">trg_ra_sex</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">label_dynamic_astrometry_target_dec</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">trg_dec_sex</span><span class="p">)</span>

        <span class="c1"># All done.</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">__refresh_dynamic_label_text_photometry</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Refresh all of the dynamic label text for photometry.</span>
<span class="sd">        This fills out the information based on the current solutions</span>
<span class="sd">        available and solved.</span>

<span class="sd">        A photometric solution must exist.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Everything in this function needs the OpihiSolution, if it does not</span>
        <span class="c1"># exist, then exit early as there is nothing to refresh.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">opihi_solution</span><span class="p">,</span> <span class="n">opihiexarata</span><span class="o">.</span><span class="n">OpihiSolution</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">opihi_solution</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">opihi_solution</span>

        <span class="c1"># The filter is provided by the image&#39;s header, a solution is not</span>
        <span class="c1"># required for displaying this information.</span>
        <span class="n">filter_name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">opihi_solution</span><span class="o">.</span><span class="n">filter_name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">label_dynamic_photometry_filter_name</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">filter_name</span><span class="p">)</span>

        <span class="c1"># Everything beyond this point requires an astrometric solution, if</span>
        <span class="c1"># it does not exist, there is no point in continuing, exiting early.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">opihi_solution</span><span class="o">.</span><span class="n">photometrics</span><span class="p">,</span> <span class="n">photometry</span><span class="o">.</span><span class="n">PhotometricSolution</span>
        <span class="p">):</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">photometrics</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">opihi_solution</span><span class="o">.</span><span class="n">photometrics</span>

        <span class="c1"># Obtaining the computed zero point of the image. Some rounding is</span>
        <span class="c1"># needed so it can properly fit in the GUI.</span>
        <span class="n">zero_point</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">photometrics</span><span class="o">.</span><span class="n">zero_point</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">zero_point_error</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">photometrics</span><span class="o">.</span><span class="n">zero_point_error</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="c1"># Building the string for display and updating the text.</span>
        <span class="n">pm_sym</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\u00B1</span><span class="s2">&quot;</span>
        <span class="n">zero_point_str</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{zp}</span><span class="s2"> </span><span class="si">{pm}</span><span class="s2"> </span><span class="si">{err}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="n">zp</span><span class="o">=</span><span class="n">zero_point</span><span class="p">,</span> <span class="n">pm</span><span class="o">=</span><span class="n">pm_sym</span><span class="p">,</span> <span class="n">err</span><span class="o">=</span><span class="n">zero_point_error</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">label_dynamic_photometry_zero_point_value</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">zero_point_str</span><span class="p">)</span>

        <span class="c1"># All done.</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">__refresh_dynamic_label_text_orbit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Refresh all of the dynamic label text for orbit.</span>
<span class="sd">        This fills out the information based on the current solutions</span>
<span class="sd">        available and solved.</span>

<span class="sd">        An orbital solution must exist.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Everything in this function needs the OpihiSolution, if it does not</span>
        <span class="c1"># exist, then exit early as there is nothing to refresh.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">opihi_solution</span><span class="p">,</span> <span class="n">opihiexarata</span><span class="o">.</span><span class="n">OpihiSolution</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">opihi_solution</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">opihi_solution</span>

        <span class="c1"># Nothing so far.</span>
        <span class="k">pass</span>

        <span class="c1"># Everything beyond this point requires an orbital solution, if</span>
        <span class="c1"># it does not exist, there is no point in continuing, exiting early.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">opihi_solution</span><span class="o">.</span><span class="n">orbitals</span><span class="p">,</span> <span class="n">orbit</span><span class="o">.</span><span class="n">OrbitalSolution</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">orbitals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">opihi_solution</span><span class="o">.</span><span class="n">orbitals</span>

        <span class="c1"># Refreshing the values of the Keplerian orbital elements.</span>
        <span class="c1"># The orbital elements&#39; values and errors should be reported. We define</span>
        <span class="c1"># the string formatting here.</span>
        <span class="k">def</span> <span class="nf">orb_str_conv</span><span class="p">(</span><span class="n">val</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">err</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
            <span class="sd">&quot;&quot;&quot;Unified string formatting for orbital element values and errors.&quot;&quot;&quot;</span>
            <span class="c1"># Rounding values to sensible values.</span>
            <span class="n">val</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
            <span class="n">err</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">err</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
            <span class="c1"># Building the string, allowing for the usage of the plus minus</span>
            <span class="c1"># symbol to demark the error.</span>
            <span class="n">pm_sym</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\u00B1</span><span class="s2">&quot;</span>
            <span class="n">ele_string</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{v}</span><span class="s2"> </span><span class="si">{pm}</span><span class="s2"> </span><span class="si">{e}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">v</span><span class="o">=</span><span class="n">val</span><span class="p">,</span> <span class="n">pm</span><span class="o">=</span><span class="n">pm_sym</span><span class="p">,</span> <span class="n">e</span><span class="o">=</span><span class="n">err</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">ele_string</span>

        <span class="c1"># Using the above function to derive the display strings for all of the</span>
        <span class="c1"># elements.</span>
        <span class="n">semimajor_axis_string</span> <span class="o">=</span> <span class="n">orb_str_conv</span><span class="p">(</span>
            <span class="n">val</span><span class="o">=</span><span class="n">orbitals</span><span class="o">.</span><span class="n">semimajor_axis</span><span class="p">,</span> <span class="n">err</span><span class="o">=</span><span class="n">orbitals</span><span class="o">.</span><span class="n">semimajor_axis_error</span>
        <span class="p">)</span>
        <span class="n">eccentricity_string</span> <span class="o">=</span> <span class="n">orb_str_conv</span><span class="p">(</span>
            <span class="n">val</span><span class="o">=</span><span class="n">orbitals</span><span class="o">.</span><span class="n">eccentricity</span><span class="p">,</span> <span class="n">err</span><span class="o">=</span><span class="n">orbitals</span><span class="o">.</span><span class="n">eccentricity_error</span>
        <span class="p">)</span>
        <span class="n">inclination_string</span> <span class="o">=</span> <span class="n">orb_str_conv</span><span class="p">(</span>
            <span class="n">val</span><span class="o">=</span><span class="n">orbitals</span><span class="o">.</span><span class="n">inclination</span><span class="p">,</span> <span class="n">err</span><span class="o">=</span><span class="n">orbitals</span><span class="o">.</span><span class="n">inclination_error</span>
        <span class="p">)</span>
        <span class="n">ascending_node_string</span> <span class="o">=</span> <span class="n">orb_str_conv</span><span class="p">(</span>
            <span class="n">val</span><span class="o">=</span><span class="n">orbitals</span><span class="o">.</span><span class="n">longitude_ascending_node</span><span class="p">,</span>
            <span class="n">err</span><span class="o">=</span><span class="n">orbitals</span><span class="o">.</span><span class="n">longitude_ascending_node_error</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">perihelion_string</span> <span class="o">=</span> <span class="n">orb_str_conv</span><span class="p">(</span>
            <span class="n">val</span><span class="o">=</span><span class="n">orbitals</span><span class="o">.</span><span class="n">argument_perihelion</span><span class="p">,</span> <span class="n">err</span><span class="o">=</span><span class="n">orbitals</span><span class="o">.</span><span class="n">argument_perihelion_error</span>
        <span class="p">)</span>
        <span class="n">mean_anomaly_string</span> <span class="o">=</span> <span class="n">orb_str_conv</span><span class="p">(</span>
            <span class="n">val</span><span class="o">=</span><span class="n">orbitals</span><span class="o">.</span><span class="n">mean_anomaly</span><span class="p">,</span> <span class="n">err</span><span class="o">=</span><span class="n">orbitals</span><span class="o">.</span><span class="n">mean_anomaly_error</span>
        <span class="p">)</span>
        <span class="c1"># Changing the text using the derived strings.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">line_edit_orbit_semimajor_axis</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">semimajor_axis_string</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">line_edit_orbit_eccentricity</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">eccentricity_string</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">line_edit_orbit_inclination</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">inclination_string</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">line_edit_orbit_ascending_node</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">ascending_node_string</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">line_edit_orbit_perihelion</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">perihelion_string</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">line_edit_orbit_mean_anomaly</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">mean_anomaly_string</span><span class="p">)</span>

        <span class="c1"># Maximum precision on the epoch Julian day is desired however.</span>
        <span class="n">julian_day_string</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">orbitals</span><span class="o">.</span><span class="n">epoch_julian_day</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">line_edit_orbit_epoch</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">julian_day_string</span><span class="p">)</span>

        <span class="c1"># All done.</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">__refresh_dynamic_label_text_ephemeris</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Refresh all of the dynamic label text for ephemerides.</span>
<span class="sd">        This fills out the information based on the current solutions</span>
<span class="sd">        available and solved.</span>

<span class="sd">        An ephemeritic solution must exist.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Everything in this function needs the OpihiSolution, if it does not</span>
        <span class="c1"># exist, then exit early as there is nothing to refresh.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">opihi_solution</span><span class="p">,</span> <span class="n">opihiexarata</span><span class="o">.</span><span class="n">OpihiSolution</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">opihi_solution</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">opihi_solution</span>

        <span class="c1"># Nothing so far.</span>
        <span class="k">pass</span>

        <span class="c1"># Everything beyond this point requires an orbital solution, if</span>
        <span class="c1"># it does not exist, there is no point in continuing, exiting early.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">opihi_solution</span><span class="o">.</span><span class="n">ephemeritics</span><span class="p">,</span> <span class="n">ephemeris</span><span class="o">.</span><span class="n">EphemeriticSolution</span>
        <span class="p">):</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ephemeritics</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">opihi_solution</span><span class="o">.</span><span class="n">ephemeritics</span>

        <span class="c1"># Update the rate text with the velocity terms provided by the</span>
        <span class="c1"># propagation solution. The propagation solution provides rates as</span>
        <span class="c1"># degrees per second.</span>
        <span class="n">ra_v_deg</span> <span class="o">=</span> <span class="n">ephemeritics</span><span class="o">.</span><span class="n">ra_velocity</span>
        <span class="n">dec_v_deg</span> <span class="o">=</span> <span class="n">ephemeritics</span><span class="o">.</span><span class="n">dec_velocity</span>
        <span class="c1"># And acceleration, as degrees per second squared.</span>
        <span class="n">ra_a_deg</span> <span class="o">=</span> <span class="n">ephemeritics</span><span class="o">.</span><span class="n">ra_acceleration</span>
        <span class="n">dec_a_deg</span> <span class="o">=</span> <span class="n">ephemeritics</span><span class="o">.</span><span class="n">dec_acceleration</span>
        <span class="c1"># Converting to the more familiar arcsec/s from deg/s along with</span>
        <span class="c1"># arcsec/s/s from deg/s/s. Round after and prepare to make it a</span>
        <span class="c1"># string for the GUI.</span>
        <span class="k">def</span> <span class="nf">vel_deg_to_arcsec_str</span><span class="p">(</span><span class="n">degree</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">degree</span> <span class="o">*</span> <span class="mi">3600</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

        <span class="k">def</span> <span class="nf">accl_deg_to_arcsec_str</span><span class="p">(</span><span class="n">degree</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
            <span class="c1"># Accelerations are usually a lot less and thus should get their</span>
            <span class="c1"># own method of manipulation.</span>
            <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{acc:2.3e}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">acc</span><span class="o">=</span><span class="n">degree</span><span class="p">))</span>

        <span class="n">ra_v_arcsec_str</span> <span class="o">=</span> <span class="n">vel_deg_to_arcsec_str</span><span class="p">(</span><span class="n">ra_v_deg</span><span class="p">)</span>
        <span class="n">dec_v_arcsec_str</span> <span class="o">=</span> <span class="n">vel_deg_to_arcsec_str</span><span class="p">(</span><span class="n">dec_v_deg</span><span class="p">)</span>
        <span class="n">ra_a_arcsec_str</span> <span class="o">=</span> <span class="n">accl_deg_to_arcsec_str</span><span class="p">(</span><span class="n">ra_a_deg</span><span class="p">)</span>
        <span class="n">dec_a_arcsec_str</span> <span class="o">=</span> <span class="n">accl_deg_to_arcsec_str</span><span class="p">(</span><span class="n">dec_a_deg</span><span class="p">)</span>
        <span class="c1"># Update the dynamic text.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">label_dynamic_ephemeris_ra_velocity</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">ra_v_arcsec_str</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">label_dynamic_ephemeris_dec_velocity</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">dec_v_arcsec_str</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">label_dynamic_ephemeris_ra_acceleration</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">ra_a_arcsec_str</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">label_dynamic_ephemeris_dec_acceleration</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">dec_a_arcsec_str</span><span class="p">)</span>

        <span class="c1"># All done.</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">__refresh_dynamic_label_text_propagate</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Refresh all of the dynamic label text for propagate.</span>
<span class="sd">        This fills out the information based on the current solutions</span>
<span class="sd">        available and solved.</span>

<span class="sd">        A propagative solution must exist.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Everything in this function needs the OpihiSolution, if it does not</span>
        <span class="c1"># exist, then exit early as there is nothing to refresh.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">opihi_solution</span><span class="p">,</span> <span class="n">opihiexarata</span><span class="o">.</span><span class="n">OpihiSolution</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">opihi_solution</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">opihi_solution</span>

        <span class="c1"># Nothing so far.</span>
        <span class="k">pass</span>

        <span class="c1"># Everything beyond this point requires an astrometric solution, if</span>
        <span class="c1"># it does not exist, there is no point in continuing, exiting early.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">opihi_solution</span><span class="o">.</span><span class="n">propagatives</span><span class="p">,</span> <span class="n">propagate</span><span class="o">.</span><span class="n">PropagativeSolution</span>
        <span class="p">):</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">propagatives</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">opihi_solution</span><span class="o">.</span><span class="n">propagatives</span>

        <span class="c1"># Update the rate text with the velocity terms provided by the</span>
        <span class="c1"># propagation solution. The propagation solution provides rates as</span>
        <span class="c1"># degrees per second.</span>
        <span class="n">ra_v_deg</span> <span class="o">=</span> <span class="n">propagatives</span><span class="o">.</span><span class="n">ra_velocity</span>
        <span class="n">dec_v_deg</span> <span class="o">=</span> <span class="n">propagatives</span><span class="o">.</span><span class="n">dec_velocity</span>
        <span class="c1"># And acceleration, as degrees per second squared.</span>
        <span class="n">ra_a_deg</span> <span class="o">=</span> <span class="n">propagatives</span><span class="o">.</span><span class="n">ra_acceleration</span>
        <span class="n">dec_a_deg</span> <span class="o">=</span> <span class="n">propagatives</span><span class="o">.</span><span class="n">dec_acceleration</span>
        <span class="c1"># Converting to the more familiar arcsec/s from deg/s along with</span>
        <span class="c1"># arcsec/s/s from deg/s/s. Round after and prepare to make it a</span>
        <span class="c1"># string for the GUI.</span>
        <span class="k">def</span> <span class="nf">vel_deg_to_arcsec_str</span><span class="p">(</span><span class="n">degree</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">degree</span> <span class="o">*</span> <span class="mi">3600</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

        <span class="k">def</span> <span class="nf">accl_deg_to_arcsec_str</span><span class="p">(</span><span class="n">degree</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
            <span class="c1"># Accelerations are usually a lot less and thus should get their</span>
            <span class="c1"># own method of manipulation.</span>
            <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{acc:2.3e}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">acc</span><span class="o">=</span><span class="n">degree</span><span class="p">))</span>

        <span class="n">ra_v_arcsec_str</span> <span class="o">=</span> <span class="n">vel_deg_to_arcsec_str</span><span class="p">(</span><span class="n">ra_v_deg</span><span class="p">)</span>
        <span class="n">dec_v_arcsec_str</span> <span class="o">=</span> <span class="n">vel_deg_to_arcsec_str</span><span class="p">(</span><span class="n">dec_v_deg</span><span class="p">)</span>
        <span class="n">ra_a_arcsec_str</span> <span class="o">=</span> <span class="n">accl_deg_to_arcsec_str</span><span class="p">(</span><span class="n">ra_a_deg</span><span class="p">)</span>
        <span class="n">dec_a_arcsec_str</span> <span class="o">=</span> <span class="n">accl_deg_to_arcsec_str</span><span class="p">(</span><span class="n">dec_a_deg</span><span class="p">)</span>
        <span class="c1"># Update the dynamic text.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">label_dynamic_propagate_ra_velocity</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">ra_v_arcsec_str</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">label_dynamic_propagate_dec_velocity</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">dec_v_arcsec_str</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">label_dynamic_propagate_ra_acceleration</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">ra_a_arcsec_str</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">label_dynamic_propagate_dec_acceleration</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">dec_a_arcsec_str</span><span class="p">)</span>

        <span class="c1"># Use the current time and date to determine the future positions with</span>
        <span class="c1"># the time interval provided.</span>
        <span class="n">ENTRY_COUNT</span> <span class="o">=</span> <span class="n">library</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">GUI_PROPAGATE_PRECOMPUTED_FUTURE_ENTRY_COUNT</span>
        <span class="n">INTERVAL</span> <span class="o">=</span> <span class="n">library</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">GUI_PROPAGATE_PRECOMPUTED_FUTURE_TIMESTEP_SECONDS</span>
        <span class="n">INTERVAL_DAYS</span> <span class="o">=</span> <span class="n">INTERVAL</span> <span class="o">/</span> <span class="mi">86400</span>
        <span class="n">current_julian_day</span> <span class="o">=</span> <span class="n">library</span><span class="o">.</span><span class="n">conversion</span><span class="o">.</span><span class="n">current_utc_to_julian_day</span><span class="p">()</span>
        <span class="n">precomputed_future_text</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">for</span> <span class="n">countdex</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">ENTRY_COUNT</span><span class="p">)):</span>
            <span class="c1"># The future Julian day time for this future, as the Julian time</span>
            <span class="c1"># scale is in days.</span>
            <span class="n">future_julian_day</span> <span class="o">=</span> <span class="n">current_julian_day</span> <span class="o">+</span> <span class="n">INTERVAL_DAYS</span> <span class="o">*</span> <span class="n">countdex</span>
            <span class="c1"># Converting this to the date and time string for this entry.</span>
            <span class="c1"># As this is UNIX time, the date is in UTC or Zulu time.</span>
            <span class="n">yr</span><span class="p">,</span> <span class="n">mh</span><span class="p">,</span> <span class="n">dy</span><span class="p">,</span> <span class="n">hr</span><span class="p">,</span> <span class="n">mn</span><span class="p">,</span> <span class="n">sc</span> <span class="o">=</span> <span class="n">library</span><span class="o">.</span><span class="n">conversion</span><span class="o">.</span><span class="n">julian_day_to_full_date</span><span class="p">(</span>
                <span class="n">jd</span><span class="o">=</span><span class="n">future_julian_day</span>
            <span class="p">)</span>
            <span class="n">datetime_str</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{yr}</span><span class="s2">-</span><span class="si">{mh}</span><span class="s2">-</span><span class="si">{dy}</span><span class="s2">  </span><span class="si">{hr}</span><span class="s2">:</span><span class="si">{mn}</span><span class="s2">:</span><span class="si">{sc}</span><span class="s2">  Z&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">yr</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">yr</span><span class="p">),</span> <span class="n">mh</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">mh</span><span class="p">),</span> <span class="n">dy</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">dy</span><span class="p">),</span> <span class="n">hr</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">hr</span><span class="p">),</span> <span class="n">mn</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">mn</span><span class="p">),</span> <span class="n">sc</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">sc</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="c1"># Using the Julian day time to compute the propagated solution for</span>
            <span class="c1"># this time and formatting this as the needed string.</span>
            <span class="n">ra_deg</span><span class="p">,</span> <span class="n">dec_deg</span> <span class="o">=</span> <span class="n">propagatives</span><span class="o">.</span><span class="n">forward_propagate</span><span class="p">(</span>
                <span class="n">future_time</span><span class="o">=</span><span class="n">future_julian_day</span>
            <span class="p">)</span>
            <span class="n">ra_sex</span><span class="p">,</span> <span class="n">dec_sex</span> <span class="o">=</span> <span class="n">library</span><span class="o">.</span><span class="n">conversion</span><span class="o">.</span><span class="n">degrees_to_sexagesimal_ra_dec</span><span class="p">(</span>
                <span class="n">ra_deg</span><span class="o">=</span><span class="n">ra_deg</span><span class="p">,</span> <span class="n">dec_deg</span><span class="o">=</span><span class="n">dec_deg</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span>
            <span class="p">)</span>
            <span class="n">ra_dec_str</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{ra}</span><span class="s2">   </span><span class="si">{dec}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ra</span><span class="o">=</span><span class="n">ra_sex</span><span class="p">,</span> <span class="n">dec</span><span class="o">=</span><span class="n">dec_sex</span><span class="p">)</span>
            <span class="c1"># The final format for this line per the GUI specification, just</span>
            <span class="c1"># adding some space and the new line</span>
            <span class="n">entry_line</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{dt}</span><span class="s2">   |   </span><span class="si">{rd}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dt</span><span class="o">=</span><span class="n">datetime_str</span><span class="p">,</span> <span class="n">rd</span><span class="o">=</span><span class="n">ra_dec_str</span><span class="p">)</span>
            <span class="n">precomputed_future_text</span> <span class="o">=</span> <span class="n">precomputed_future_text</span> <span class="o">+</span> <span class="n">entry_line</span>
        <span class="c1"># Set the text for the set of future solutions.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">text_browser_propagate_future_results</span><span class="o">.</span><span class="n">setPlainText</span><span class="p">(</span>
            <span class="n">precomputed_future_text</span>
        <span class="p">)</span>

        <span class="c1"># All done.</span>
        <span class="k">return</span> <span class="kc">None</span>

<div class="viewcode-block" id="OpihiManualWindow.redraw_opihi_image"><a class="viewcode-back" href="../../../code/opihiexarata.gui.manual.html#opihiexarata.gui.manual.OpihiManualWindow.redraw_opihi_image">[docs]</a>    <span class="k">def</span> <span class="nf">redraw_opihi_image</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Redraw the Opihi image given that new results may have been added</span>
<span class="sd">        because some solutions were completed. This modifies the GUI in-place.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># The data that will be plotted.</span>
        <span class="n">plotting_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">opihi_solution</span><span class="o">.</span><span class="n">data</span>

        <span class="c1"># This is a function which allows for the disabling of other axes</span>
        <span class="c1"># formatting their data values and messing with the formatter class.</span>
        <span class="k">def</span> <span class="nf">empty_string</span><span class="p">(</span><span class="n">string</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">str</span><span class="p">()</span>

        <span class="c1"># We set the bounds of the colorbar based on the 1-99 % bounds.</span>
        <span class="n">colorbar_low</span><span class="p">,</span> <span class="n">colorbar_high</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanpercentile</span><span class="p">(</span><span class="n">plotting_data</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">99</span><span class="p">])</span>

        <span class="c1"># Clear the information before re-plotting, it is easier just to draw</span>
        <span class="c1"># it all again.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">opihi_axes</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>

        <span class="c1"># Attempt to plot the image data if it exists.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">opihi_solution</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">image</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">opihi_axes</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span>
                <span class="n">plotting_data</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="n">colorbar_low</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">colorbar_high</span>
            <span class="p">)</span>
            <span class="c1"># Disable their formatting in favor of ours.</span>
            <span class="n">image</span><span class="o">.</span><span class="n">format_cursor_data</span> <span class="o">=</span> <span class="n">empty_string</span>

        <span class="c1"># Attempt to plot the location of the specified asteroid.</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">target_x</span><span class="p">,</span> <span class="n">target_y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">opihi_solution</span><span class="o">.</span><span class="n">asteroid_location</span>
            <span class="n">TARGET_MARKER_SIZE</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">library</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">GUI_IMAGE_PLOT_TARGET_MARKER_SIZE</span><span class="p">)</span>
            <span class="n">target_marker</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">opihi_axes</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
                <span class="n">target_x</span><span class="p">,</span>
                <span class="n">target_y</span><span class="p">,</span>
                <span class="n">s</span><span class="o">=</span><span class="n">TARGET_MARKER_SIZE</span><span class="p">,</span>
                <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;^&quot;</span><span class="p">,</span>
                <span class="n">color</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span>
                <span class="n">facecolors</span><span class="o">=</span><span class="s2">&quot;None&quot;</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="c1"># Disable their formatting in favor of ours.</span>
            <span class="n">target_marker</span><span class="o">.</span><span class="n">format_cursor_data</span> <span class="o">=</span> <span class="n">empty_string</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="c1"># TESTING</span>
        <span class="n">rand</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">opihi_axes</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rand</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">rand</span><span class="p">)</span>

        <span class="c1"># Make sure the coordinate formatter does not change.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">opihi_axes</span><span class="o">.</span><span class="n">format_coord</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_opihi_coordinate_formatter</span>
        <span class="c1"># Update and redraw the image via redrawing the canvas.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">opihi_canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
        <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="OpihiManualWindow.save_results"><a class="viewcode-back" href="../../../code/opihiexarata.gui.manual.html#opihiexarata.gui.manual.OpihiManualWindow.save_results">[docs]</a>    <span class="k">def</span> <span class="nf">save_results</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Save all of the results of the solutions to date. This is especially</span>
<span class="sd">        done upon selecting a new image, the previous image results are</span>
<span class="sd">        saved.</span>

<span class="sd">        If there is no solution class, then there is no results to save either</span>
<span class="sd">        and this function does nothing.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># If there is no solution class, there is nothing to save. Exiting</span>
        <span class="c1"># early.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">opihi_solution</span><span class="p">,</span> <span class="n">opihiexarata</span><span class="o">.</span><span class="n">OpihiSolution</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="c1"># There are two primary things to save, the image and solution</span>
        <span class="c1"># information and the MPC record as retrievable historical data.</span>
        <span class="k">def</span> <span class="nf">_save_results_fits_image</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
            <span class="sd">&quot;&quot;&quot;First, doing the image data.&quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">_save_results_mpcrecord</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
            <span class="sd">&quot;&quot;&quot;Second, the MPC record historical data.&quot;&quot;&quot;</span>
            <span class="c1"># The current record to add.</span>
            <span class="n">mpc_record</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">opihi_solution</span><span class="o">.</span><span class="n">mpc_record_row</span><span class="p">()</span>
            <span class="c1"># Adding the new line character as write lines do not do this.</span>
            <span class="n">mpc_record</span> <span class="o">=</span> <span class="n">mpc_record</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="c1"># If the record file already exists, append this information to it.</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__get_mpc_record_filename</span><span class="p">(),</span> <span class="s2">&quot;a&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">mpcfile</span><span class="p">:</span>
                <span class="n">mpcfile</span><span class="o">.</span><span class="n">writelines</span><span class="p">([</span><span class="n">mpc_record</span><span class="p">])</span>
            <span class="c1"># All done.</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="c1"># Executing the saving functions.</span>
        <span class="n">_save_results_fits_image</span><span class="p">()</span>
        <span class="n">_save_results_mpcrecord</span><span class="p">()</span>
        <span class="c1"># All done.</span>
        <span class="k">return</span> <span class="kc">None</span></div></div>


<div class="viewcode-block" id="start_manual_window"><a class="viewcode-back" href="../../../code/opihiexarata.gui.manual.html#opihiexarata.gui.manual.start_manual_window">[docs]</a><span class="k">def</span> <span class="nf">start_manual_window</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;This is the function to create the manual window for usage.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    None</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Creating the application and its infrastructure.</span>
    <span class="n">app</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QApplication</span><span class="p">([])</span>
    <span class="c1"># The manual GUI window.</span>
    <span class="n">manual_window</span> <span class="o">=</span> <span class="n">OpihiManualWindow</span><span class="p">()</span>
    <span class="n">manual_window</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="c1"># Closing out of the window.</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="n">app</span><span class="o">.</span><span class="n">exec</span><span class="p">())</span>
    <span class="c1"># All done.</span>
    <span class="k">return</span> <span class="kc">None</span></div>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">start_manual_window</span><span class="p">()</span>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Kenji Sparrow Emerson.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script> 

</body>
</html>